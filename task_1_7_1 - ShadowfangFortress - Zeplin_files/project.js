!function(){"use strict";function e(e){return"invited"===e.user.status?"Pending Invitation":"owner"===e.role?"Owner":"admin"===e.role?"Admin":""}function t(t){var n=document.importNode(Fi.content,!0);Zeplin.setGravatar(n.querySelector(".memberImage"),t.user.email,{size:80}),n.querySelector(".member").dataset.id=t.user._id,n.querySelector(".member").dataset.role=t.role,n.querySelector(".member").dataset.user=Zeplin.user._id===t.user._id?"own":"",n.querySelector(".member").dataset.status=t.user.status,n.querySelector(".memberName").textContent=t.user.username||t.user.email,n.querySelector(".memberName").title=t.user.username||t.user.email,n.querySelector(".memberRole").textContent=e(t),so.appendChild(n)}function n(e){En.users=(e||En.users).sort(C),ao.classList.toggle("lonely",1===En.users.length),so.innerHTML="",En.users.forEach(t),Ci&&De(),kn=new RegExp("@(?:everyone|all|tutti|"+En.users.filter(function(e){return e.user.username}).map(function(e){return e.user.username}).join("|")+")\\b","gi"),Zeplin.getUserInfo().then(function(e){if(En.users){for(var t=0;t<En.users.length;t++)En.users[t].user._id===e._id&&(document.body.dataset.userRole=En.users[t].role);En.integration&&En.integration.slack&&En.integration.slack.length?(Ei.querySelector(".addSlack").href=c(),Ei.querySelector(".addSlack").addEventListener("click",a)):(xo.href=c(),xo.addEventListener("click",a))}}),Ai&&w(Ai)}function o(){fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/users",{headers:Zeplin.headers}).then(function(e){return e.json().then(function(t){if(e.ok)return t;throw Zeplin.createError(e.status,t)})}).then(function(e){n(e.users),"did"in xi&&Pe(xi.did,xi.cmid)})["catch"](function(e){console.error(e),e instanceof ServerError?Zeplin.createDialog({title:e.title,message:e.message}):e instanceof ClientError?Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status&&(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html"))}}}):console.error("Network error while getting project users.")})}function r(){Hi={},En.colors&&En.colors.forEach(function(e){var t=new Zeplin.Color(e),n=t.toCSS().replace("(","\\(").replace(")","\\)");Hi[n]=t.name})}function i(){xi={},location.hash?(location.hash.substr(1).split("&").forEach(function(e){var t=e.split("="),n=decodeURIComponent(t[1]);xi[decodeURIComponent(t[0])]=-1===n.indexOf(",")?n:n.split(",")}),"pid"in xi?En&&En._id===xi.pid?b():S(xi.pid):location.replace("projects.html")):location.replace("projects.html")}function a(){localStorage.setItem("slackState",Ki)}function c(){var e={scope:"incoming-webhook",client_id:"2330702581.8730394641",redirect_uri:location.origin+"/huggingSlack.html?pid="+En._id,state:Ki},t=[];for(var n in e)t.push(n+"="+encodeURIComponent(e[n]));return En.integration&&En.integration.slack&&En.integration.slack.length&&t.push("team="+encodeURIComponent(En.integration.slack[0].teamId)),"https://slack.com/oauth/authorize?"+t.join("&")}function l(e){e&&Ci&&Ci.dots&&e.forEach(function(e){var t=document.querySelector(".dot[data-id='"+e+"']");t&&t.classList.add("highlight")})}function d(e){if(e){if(Array.isArray(e)){var t,n=wi.comments.length;if(e.forEach(function(e){var o=jr.querySelector(".comment[data-id='"+e+"']");o&&o.classList.add("highlight");var r=parseInt(o.dataset.index,10);n>r&&(n=r,t=o)}),t){var o=Pr.getBoundingClientRect().top,r=t.getBoundingClientRect().top,i=r-o;setTimeout(function(){"scrollBy"in Element.prototype?jr.scrollBy({top:i-24,behavior:"smooth"}):jr.scrollTop+=i-24},200)}}else{var a="string"==typeof e?jr.querySelector(".comment[data-id='"+e+"']"):e;if(!a)return;a.classList.add("new"),a.scrollIntoView(),setTimeout(function(){a.classList.add("highlight"),setTimeout(function(){a.classList.remove("highlight"),a.addEventListener("transitionend",function e(){a.removeEventListener("transitionend",e),a.classList.remove("new")})},1e3)},150)}delete xi.cmid,delete xi.cmids;var s=[];for(var c in xi)s.push(c+"="+xi[c]);location.hash=s.join("&")}}function u(e){if(e&&bi){m();var t,n=En.screens.length;if(e.forEach(function(e){var o=document.querySelector(".screenLink[data-id='"+e+"']");if(o){o.classList.add("highlight");var r=parseInt(o.dataset.index,10);n>r&&(n=r,t=o)}}),t){var o=t.getBoundingClientRect().top;setTimeout(function(){"scrollBy"in Element.prototype?qn.scrollBy({top:o-150,behavior:"smooth"}):qn.scrollTop+=o-150},200)}delete xi.dashboard,delete xi.sids;var r=[];for(var i in xi)r.push(i+"="+xi[i]);location.hash=r.join("&")+"&dashboard"}}function m(){[].forEach.call(An.querySelectorAll(".screen.highlight"),function(e){e.classList.remove("highlight")})}function p(e){if(e){Array.isArray(e)||(e=[e]),g(),e.forEach(function(e){var t=Lo.querySelector(".color[data-id='"+e+"']");t&&t.classList.add("highlight")}),delete xi.styleguide,delete xi.cid,delete xi.cids;var t=[];for(var n in xi)t.push(n+"="+xi[n]);location.hash=t.join("&")+"&styleguide"}}function g(){[].forEach.call(Lo.querySelectorAll(".color.highlight"),function(e){e.classList.remove("highlight")})}function f(e){Ci=null,wi=null,ki=null,Ii=null,bn=null,Zi=null,_i=null,Oi=null,Di=null,document.body.dataset.projectType=e.type,"web"===e.type?(Zeplin.projectPrefs.get(xi.pid,"webStyleExportType").then(function(e){vo.dataset.exportType=e,br.textContent=gn[e],document.querySelector("input[name='webColorType'][value='"+e+"']").checked=!0,document.querySelector("input[name='styleExportType'][value='"+e+"']").checked=!0}),Zeplin.projectPrefs.get(xi.pid,"webShowDimensions").then(function(e){Cr.checked=e}),Zeplin.projectPrefs.get(xi.pid,"webUnitlessLineHeight").then(function(e){wr.checked=e}),vn||Me()):vn&&(vn=null,Ir.querySelector(".CodeMirror").remove()),bi=!0,E(),Qn.textContent=e.name,Qn.title=e.name,jn.value=e.name,Mn.textContent=Zeplin.projectTypes[e.type];var t={ios:'IOS developers usually prefer color names defined in "camel case", which looks like: brightRed',osx:'IOS developers usually prefer color names defined in "camel case", which looks like: brightRed',web:"Web developers usually use underscores or dashes while defining colors, which looks like: bright-red or bright_red",android:"Android developers define their color names using underscore, which look like: bright_red"};if(vi.querySelector(".projectNaming").textContent=t[e.type],e.integration&&e.integration.slack&&e.integration.slack.length){var i=new URL(e.integration.slack[0].incomingWebHook.configurationURL),s=e.integration.slack[e.integration.slack.length-1].incomingWebHook.channel;document.getElementById("slackChannel").textContent=s,document.getElementById("slackChannel").title=s,document.getElementById("slackChannel").href=i.origin+"/messages/"+s,Ei.querySelector(".slackSettings").href=e.integration.slack[e.integration.slack.length-1].incomingWebHook.configurationURL,document.getElementById("slackIntegration").classList.add("enabled"),document.getElementById("slackIntegrationRow").classList.add("hidden"),e.integration.slack.length>1&&e.integration.slack.slice(0,e.integration.slack.length-1).reverse().forEach(cn)}else xo.href=c(),xo.addEventListener("click",a);Ti="android"===e.type?"mdpi":"1x",h(e.density),e.users?n(e.users):o(),H(),Se(),Un.setAttribute("datetime",e.updated||(new Date).toISOString()),r(),Lo.innerHTML="",e.colors&&e.colors.length&&e.colors.forEach(F),e.prefix&&y(e.prefix),b()}function h(e){switch(En.density=e,e){case"mdpi":case"1x":case"web":case"unknown":default:Sn=1;break;case"hdpi":Sn=1.5;break;case"xhdpi":case"2x":Sn=2;break;case"xxhdpi":case"3x":Sn=3;break;case"xxxhdpi":case"4x":Sn=4}if("unknown"===e)Cn="px",wn="px";else switch(En.type){case"android":Cn="dp",wn="sp";break;case"ios":case"osx":Cn="pt",wn="pt";break;case"web":default:Cn="px",wn="px"}document.getElementById("projectDensity").textContent=e}function y(e){En.prefix=e,po.value=e.toUpperCase()+"Colors",go.value=e,ho.value=En.prefix.toUpperCase()+"Colors",yo.value=En.prefix}function v(){var e=An.children.length,t=xe(),n="";if(t.length)if(n+=" tagged with ",1===t.length)n+=t,document.querySelector(".projectSummary").classList.add("showHint");else{var o=t.pop();n+=t.join(", ")+", and "+o,document.querySelector(".projectSummary").classList.remove("showHint")}else document.querySelector(".projectSummary").classList.remove("showHint");Nn.textContent=(e||"No")+" screen"+(1===e?"":"s")+n}function E(){var e="";"dashboard"===Ln?e="Dashboard - ":"styleguide"===Ln?e="Styleguide - ":En&&En.screens&&Si>=0&&Si<En.screens.length&&(e=En.screens[Si].name+" - "),Yn.textContent=e+(En?En.name+" - ":"")+"Zeplin"}function L(e){var t=!0;e&&"updateURL"in e&&(t=e.updateURL),t&&(location.hash="pid="+xi.pid+"&dashboard"),Ln="dashboard",Si=-2,Ci=null,E(),Oe(),Vn.dataset.selection="dashboard",zn.checked=!0,Vn.classList.add("tabs"),g(),window.CSS&&CSS.supports("grid-template-columns","repeat(auto-fill, 220px)")||(P(),window.addEventListener("resize",A))}function x(e){var t=!0;e&&"updateURL"in e&&(t=e.updateURL),t&&(location.hash="pid="+xi.pid+"&styleguide"),Ln="styleguide",Si=-1,Ci=null,E(),Oe(),Vn.dataset.selection="styleguide",Wn.checked=!0,Vn.classList.add("tabs"),m(),window.CSS&&CSS.supports("grid-template-columns","repeat(auto-fill, 220px)")||(clearTimeout(zi),window.removeEventListener("resize",A))}function b(){"sids"in xi||"sid"in xi||"dashboard"in xi||"styleguide"in xi||(xi.dashboard=""),"sid"in xi?(Ci&&Ci._id===xi.sid||Le(xi.sid,{updateURL:!1}),"dots"in Ci&&("did"in xi?Pe(xi.did,xi.cmid||xi.cmids):l(xi.dids))):"sids"in xi?("dashboard"!==Ln&&L({updateURL:!1}),u(xi.sids)):"dashboard"in xi&&"dashboard"!==Ln?L():"cid"in xi||"cids"in xi?("styleguide"!==Ln&&x({updateURL:!1}),p(xi.cid||xi.cids)):"styleguide"in xi&&"styleguide"!==Ln&&x(),"screens"in En&&U(Si)}function S(e){Ni||_n.classList.remove("hidden"),fetch(Zeplin.urls.baseURL+"/projects/"+e,{headers:Zeplin.headers}).then(function(e){return e.json().then(function(t){if(e.ok)return t;throw Zeplin.createError(e.status,t)})}).then(function(e){En=e,f(En),Ni=!1})["catch"](function(e){console.error(e),e instanceof ServerError?Zeplin.createDialog({title:e.title,message:e.message}):e instanceof ClientError?Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status?(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html")):location.replace("projects.html")}}}):Ni?location.reload():console.error("Network error while getting project details.")}).then(function(){_n.classList.add("hidden")},function(){_n.classList.add("hidden")})}function C(e,t){return"owner"===e.role?-1:"owner"===t.role?1:"admin"===e.role?"admin"===t.role?e.user.username<=t.user.username?-1:1:-1:"admin"===t.role?1:e.user.username<=t.user.username?-1:1}function w(e){var t=[{user:{username:"everyone",_id:"everyone"},icon:En.icon.type}].concat(En.users);mi.classList.remove("hidden"),t.length>1?Zeplin.getUserInfo().then(function(n){if(""===e){for(var o=0;o<t.length;o++)t[o].user._id!==n._id&&t[o].user.username&&"invited"!==t[o].user.status&&Ui.push(t[o]);In=Ui[1]}else{Ui=[];for(var o=0;o<t.length;o++)t[o].user._id!==n._id&&t[o].user.username&&"invited"!==t[o].user.status&&!t[o].user.username.indexOf(e)&&Ui.push(t[o]);In&&!k(In)||(In=Ui[0])}Ui.length>0?(Ui.forEach(I),mi.scrollTop=0,mi.querySelector(".suggestedUser[data-id='"+In.user._id+"']").classList.add("selected")):(lt(),mi.classList.add("hidden"))}):lt()}function k(e){for(var t=Ui.length,n=0;t>n;n++)if(Ui[n].user._id===e.user._id)return!1;return!0}function I(e,t){var n=document.importNode(Yi.content,!0),o=n.querySelector(".suggestedUser"),r=n.querySelector(".suggestedUserName"),i=n.querySelector(".everyoneInfo"),a=n.querySelector(".suggestedUserImage"),s=n.querySelector(".projectIcon");o.dataset.id=e.user._id,o.dataset.index=t,r.textContent=e.user.username||e.user.email,r.title=e.user.username||e.user.email,"everyone"===e.user._id?(i.textContent="Notify everyone in "+En.name,s.dataset.type=e.icon,a.classList.add("hidden")):(i.textContent="",Zeplin.setGravatar(a,e.user.email,{size:36})),ui.appendChild(n)}function Z(e){return An.querySelector(".screen[data-index='"+e+"']")}function T(e){return An.querySelector(".screen[data-id='"+e+"']")}function B(e,t){t=t||{};var n=t.padding||0,o=t.unit||0;return e*Bi/window.devicePixelRatio+n+o}function _(e,t){if(void 0===e||void 0===t)return"";var n=parseFloat(e.toFixed(1)),o=Math.round(e)==n?Math.round(n):n,r=parseFloat(t.toFixed(1)),i=Math.round(t)==r?Math.round(r):r;return o+"×"+i+Cn}function O(e,t){if(void 0===e)return"";var n="text"===t?wn:Cn,o=e/Sn,r=parseFloat(o.toFixed(1));return(Math.round(o)==r?Math.round(o):r)+n}function D(){return Vn.classList.contains("fetching")?(Vn.classList.remove("fetching"),setTimeout(function(){Vn.classList.add("fetchend"),setTimeout(function(){Vn.className="",eo.textContent="Loading layers…"},1e3)},500),void Ao.classList.remove("loading")):void(Vn.className="")}function q(e,t){fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/screens/"+e._id+"/snapshots/"+e.currentSnapshot._id,{headers:Zeplin.headers}).then(function(e){return e.json().then(function(t){if(e.ok)return t;throw Zeplin.createError(e.status,t)})}).then(function(n){e.layers=n.layers,e.assets=n.assets,e.grid=n.grid,Ci&&Ci._id===e._id&&(ye(e.grid),Ee(e,t||"layers"),D()),M(),U(Si)})["catch"](function(n){console.error(n),n instanceof ServerError?(e.layers=[],Ci&&Ci._id===e._id&&(Ee(e,t||"layers"),D())):n instanceof ClientError?Zeplin.createDialog({title:n.title,message:n.message,done:{name:"OK",cb:function(){401===n.status?(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html")):(e.layers=[],Ci&&Ci._id===e._id&&(Ee(e,t||"layers"),D()))}}}):Ci&&Ci._id===e._id&&Zeplin.createDialog()})}function N(e,t){if(!navigator.onLine)return!0;0>e&&(e=0),e>=En.screens.length&&(e=En.screens.length-1);var n=En.screens[e];return n?"layers"in n&&"replace"!==t?!1:(Si===e&&(Vn.classList.remove("fetchend"),Vn.classList.add("fetchstart","fetching"),Ao.classList.add("loading"),Ao.classList.remove("empty"),Mo.classList.add("loading"),Mo.classList.remove("empty")),q(n,t),!0):!1}function U(e){if(!N(e))for(var t=e-1,n=e+1;t>-1||n<En.screens.length;){if(t>-1){if(N(t))return;t--}if(n<En.screens.length){if(N(n))return;n++}}}function R(e){fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/screens/"+e._id+"/dots",{headers:Zeplin.headers}).then(function(e){return e.json().then(function(t){if(e.ok)return t;throw Zeplin.createError(e.status,t)})}).then(function(t){e.dots=t.dots,Ci&&Ci._id===e._id&&(ge(e),"did"in xi?Pe(xi.did,xi.cmid||xi.cmids):l(xi.dids))})["catch"](function(t){console.error(t),t instanceof ServerError?(e.dots=[],Ci&&Ci._id===e._id&&ge(e)):t instanceof ClientError&&(401===t.status?(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html")):(e.dots=[],Ci&&Ci._id===e._id&&ge(e)))})}function P(){An.style.width=244*Math.floor(qn.clientWidth/244)+"px",zi=setTimeout(P,1e3)}function A(){clearTimeout(zi),requestAnimationFrame(P)}function j(e,t){var n=document.importNode(Wi.content,!0),o=n.querySelector(".screen");o.dataset.id=e._id,o.dataset.index=t,n.querySelector(".screenLink").href="project.html#pid="+xi.pid+"&sid="+e._id,n.querySelector(".screenImage").src=e.currentSnapshot.url,n.querySelector(".screenName").value=e.name,n.querySelector(".screenLastUpdated").setAttribute("datetime",e.updated||En.updated),An.appendChild(n)}function M(){var e=[];En.screens.forEach(function(t){t.layers&&t.layers.forEach(function(t){"text"===t.type&&-1===e.indexOf(t.fontFace)&&e.push(t.fontFace)})}),li.innerHTML="",e.sort().forEach(function(e){var t=document.createElement("div");t.classList.add("font"),t.textContent=e,li.appendChild(t)})}function H(){var e=xe();if(Rn.innerHTML="",En.screens&&En.screens.length){var t=new Set(En.screens.reduce(function(e,t){return e.concat(t.tags||[])},[])),n=[];t.forEach(function(e){n.push(e)}),n.sort().forEach(function(t){var n=document.createElement("div");n.classList.add("tag"),n.classList.toggle("selected",-1!==e.indexOf(t)),n.dataset.tag=t,n.textContent=t,Rn.appendChild(n)})}}function F(e){var t=new Zeplin.Color(e),n=document.importNode(Vi.content,!0),o=n.querySelector(".color"),r=t.toHexString().split("   ");o.dataset.id=e._id,o.dataset.color=t.toHexString(),o.dataset.rgbcolor=JSON.stringify(e),n.querySelector(".colorPreview").style.backgroundColor=t.toCSS(),n.querySelector(".colorName").value=t.name,n.querySelector(".colorHex").value=r[0].slice(1),n.querySelector(".colorAlpha").value=r[1]?r[1].replace("%",""):100,n.querySelector(".colorRGB").textContent=t.toRGBAString(),Lo.appendChild(n)}function K(e,t){for(var n,o=new Zeplin.Color(e),r=document.importNode(Gi.content,!0),i=r.querySelector(".color"),a=0;a<En.colors.length;a++){var s=En.colors[a];if(o.equals(s)){n=s;break}}n&&(i.classList.add("added"),i.dataset.id=n._id,r.querySelector(".colorName").textContent=n.name),i.dataset.color=o.toHexString(),i.dataset.rgbcolor=JSON.stringify(e),r.querySelector(".colorPreview").style.backgroundColor=o.toCSS(),r.querySelector(".colorValue").textContent=o.toPlatformString(En.type),t.appendChild(r)}function Y(e,t){var n=document.createElement("div");n.classList.add("gradient"),e.colorStops.forEach(function(e){K(e.color,n)}),t.appendChild(n)}function z(e,t){var n="text"===e?rr:cr;switch(t.fillType){case"color":K(t.color,n);break;case"gradient":Y(t.gradient,n)}}function W(e){var t=document.importNode(Ji.content,!0);t.querySelector(".shadowType").textContent=e.type,t.querySelector(".shadowOffsetX").textContent=O(e.offsetX),t.querySelector(".shadowOffsetY").textContent=O(e.offsetY),t.querySelector(".shadowBlurRadius").textContent=O(e.blurRadius),t.querySelector(".shadowSpread").textContent=O(e.spread),t.querySelector(".shadowBlurSpread").classList.toggle("hidden",!e.blurRadius&&!e.spread),mr.appendChild(t),K(e.color,mr)}function V(e){switch(e.format){case"png":return e.displayName+("1x"===e.density?"":"@"+e.density)+"."+e.format;case"pdf":case"svg":return e.displayName+"."+e.format}}function G(e){return fetch(e.url).then(function(e){return e.arrayBuffer()}).then(function(t){var n={data:t};return Object.keys(e).forEach(function(t){n[t]=e[t]}),n})}function J(e,t){return e.contents.filter(function(e){return e.format===t}).map(function(t){var n={displayName:e.displayName};return Object.keys(t).forEach(function(e){n[e]=t[e]}),n})}function X(e,t){var n;if("all"===e)n=[].concat.apply([],Ci.assets.map(function(e){return J(e,t)}));else{for(var o,r=0;r<Ci.assets.length&&(o=Ci.assets[r],o._id!==e);r++);if(!o)return Promise.reject("Asset with id "+e+" not found.");n=J(o,t)}return Promise.all(n.map(G))}function $(e,t){return X(e,t).then(function(t){var n=new JSZip;return t.forEach(function(e){n.file("drawable-"+e.density+"/"+e.displayName+"."+e.format,e.data)}),{data:URL.createObjectURL(n.generate({type:"blob"})),name:("all"===e?"assets_"+Ci.name:t[0].displayName)+"_"+(new Date).toISOString().substr(0,10)+".zip"}})}function Q(e,t){return X(e,t).then(function(n){var o,r;if(1===n.length)o=new Blob([n[0].data],{type:pn[t]}),r=V(n[0]);else{var i=new JSZip,a=(new Date).toISOString().substr(0,10);n.forEach(function(e){i.file(V(e),e.data)}),o=i.generate({type:"blob"}),r=("all"===e?"assets_"+Ci.name:n[0].displayName)+"_"+a+".zip"}return{data:URL.createObjectURL(o),name:r}})}function ee(e){var t=document.createElement("a");t.href=e.data,t.download=e.name||"assets.zip",t.classList.add("hidden"),document.body.appendChild(t),t.addEventListener("click",function(n){n.stopPropagation(),setTimeout(function(){URL.revokeObjectURL(e.data)},1500),t.remove()}),t.click()}function te(e){if(mn.canDownload&&e.button===Zeplin.MOUSE_BUTTON.LEFT&&e.target.classList.contains("exportAssets")){e.stopPropagation();var t,n=e.target.parentElement.dataset.format,o=e.target.parentElement.dataset.aid;switch(En.type){case"android":if("svg"!==n){t=$(o,n);break}case"ios":case"osx":case"web":default:t=Q(o,n)}t.then(ee)}}function ne(e){switch(e){case"mdpi":case"1x":case"web":case"unknown":default:return"1x";case"hdpi":return"1.5x";case"xhdpi":case"2x":return"2x";case"xxhdpi":case"3x":return"3x";case"xxxhdpi":case"4x":return"4x"}}function oe(e){return new Promise(function(t,n){var o=document.createElement("img"),r=document.createElement("canvas"),i=r.getContext("2d");o.addEventListener("load",function(){i.drawImage(o,0,0);for(var e=i.getImageData(0,0,o.width,o.height).data,n="210",r="light",a=0;a<e.length;a+=4)if(!(e[a+3]<255-n)&&(e[a]<n||e[a+1]<n||e[a+2]<n)){r="dark";break}t({size:_(o.width,o.height),lightness:r})}),o.addEventListener("error",function(e){n(e)}),o.crossOrigin="anonymous",o.src=e.url})}function re(e){for(var t=0;t<e.length;t++)if(e[t].density===Ti&&"png"===e[t].format)return e[t]}function ie(e){return e.filter(function(e){return"png"===e.format&&e.density!==Ti}).map(function(e){return e.url+" "+ne(e.density)}).join(", ")}function ae(e,t){var n=document.importNode(Xi.content,!0);n.querySelector(".assetExporter").dataset.aid=e.aid,n.querySelector(".assetExporter").dataset.format=e.format,n.querySelector(".assetType").textContent=e.format,n.querySelector(".assetCount").textContent=e.count,t.appendChild(n)}function se(e,t){var n=document.importNode($i.content,!0),o=re(e.contents);return oe(o).then(function(r){var i=n.querySelector(".assetPreview img"),a=n.querySelector(".assetExports");n.querySelector(".assetPreview").classList.add(r.lightness),n.querySelector(".assetSize").textContent=r.size,i.src=o.url,i.srcset=ie(e.contents),n.querySelector(".assetName").textContent=e.displayName;var s={};e.contents.forEach(function(e){e.format in s?s[e.format]++:s[e.format]=1}),a.innerHTML="";for(var c in s)ae({aid:e._id,format:c,count:s[c]},a);t.appendChild(n)})["catch"](function(e){console.error(e)})}function ce(e){var t=new Zeplin.Color(e).toHexString();Li.has(t)||(K(e,jo),Li.add(t))}function le(e,t){var n=document.importNode(Qi.content,!0),o=n.querySelector(".layer"),r=B(e.rect.width),i=B(e.rect.height);o.dataset.index=t,o.classList.toggle("wideEnough",r>120),o.classList.toggle("longEnough",i>120),o.classList.toggle("tooNarrow",3>r),o.classList.toggle("tooShort",3>i),o.style.width=B(e.rect.width,{unit:"px"}),o.dataset.width=O(e.rect.width),o.style.height=B(e.rect.height,{unit:"px"}),o.dataset.height=O(e.rect.height),o.style.left=B(e.rect.x,{unit:"px"}),o.style.top=B(e.rect.y,{unit:"px"}),zr.appendChild(n),"text"===e.type&&!e.fills.length&&e.color?ce(e.color):e.fills.forEach(function(e){switch(e.fillType){case"color":ce(e.color);break;case"gradient":e.gradient.colorStops.forEach(function(e){ce(e.color)})}}),Ao.classList.toggle("empty",!jo.children.length)}function de(e){e.classList.remove("yellow","orange","peach","green","turquoise")}function ue(e){var t=document.createElement("div"),n=fn[new Zeplin.Color(e.color).hexBase()];return t.classList.add("dot",n),t.dataset.id=e._id,t.textContent=e.name||"?",t.dataset.color=n,t.dataset.position=e.x<=.5?"left":"right",t.style.left="calc("+100*e.x+"% - 13px)",t.style.top="calc("+100*e.y+"% - 13px)",Rr.appendChild(t),Rr.lastElementChild}function me(){var e=Kr.value.trim();if(e){var t=En._id,n=Ci._id,o={author:Zeplin.user._id,note:e,created:Date.now(),updated:Date.now()},r=Xe(o);ze(),r.style.opacity=.5,Je(),Mr.classList.remove("composing"),Di.comments=[{note:e}];var i=Di;delete i.name,fetch(Zeplin.urls.baseURL+"/projects/"+t+"/screens/"+n+"/dots",{method:"POST",headers:Zeplin.headers,body:JSON.stringify(i)}).then(function(e){return e.json().then(function(t){if(e.ok)return t;throw Zeplin.createError(e.status,t)})}).then(function(e){wi=e,wi.x=i.x,wi.y=i.y,wi.color=i.color,wi.comments[0].note=i.comments[0].note,Zeplin.projectPrefs.set(xi.pid,"lastNoteColorUsed",i.color.name),Oi.dataset.id=wi._id,Oi.dataset.name=wi.name,Ci.dots.push(wi),Fr.innerHTML="&nbsp;",Kr.value="",r.dataset.id=wi.comments[0]._id,r.removeAttribute("style"),mixpanel.track("Created dot")})["catch"](function(e){console.error(e),e instanceof ServerError?(r.remove(),Mr.classList.add("composing"),Kr.focus(),Zeplin.createDialog({title:e.title,message:e.message})):e instanceof ClientError?Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status?(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html")):(r.remove(),Mr.classList.add("composing"),Kr.focus())}}}):(r.remove(),Mr.classList.add("composing"),Kr.focus(),Zeplin.createDialog())})}}function pe(e){var t=Oi.dataset.color;if(de(Oi),Oi.classList.add(e),Oi.dataset.color=e,de(Pr),Pr.classList.add(e),!wi)return void(Di.color=hn[e]);var n=En._id,o=Ci._id,r=wi._id;fetch(Zeplin.urls.baseURL+"/projects/"+n+"/screens/"+o+"/dots/"+r,{method:"PUT",headers:Zeplin.headers,body:JSON.stringify({color:hn[e]})}).then(function(e){return e.ok?void 0:e.json().then(function(t){throw Zeplin.createError(e.status,t)})}).then(function(){wi.color=hn[e],Zeplin.projectPrefs.set(xi.pid,"lastNoteColorUsed",e),mixpanel.track("Changed dot color")})["catch"](function(e){console.error(e),e instanceof ServerError?(de(Oi),Oi.classList.add(t),Oi.dataset.color=t,de(Pr),Pr.classList.add(t),Zeplin.createDialog({title:e.title,message:e.message})):e instanceof ClientError?Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status?(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html")):(de(Oi),Oi.classList.add(t),Oi.dataset.color=t,de(Pr),Pr.classList.add(t))}}}):(de(Oi),Oi.classList.add(t),Oi.dataset.color=t,de(Pr),Pr.classList.add(t),Zeplin.createDialog())})}function ge(e){Oe(),Rr.innerHTML="",e.dots&&e.dots.forEach(ue)}function fe(e){ko.innerHTML="",e.tags&&e.tags.sort().forEach(function(e){var t=document.createElement("div");t.classList.add("tag"),t.dataset.tag=e,t.textContent=e,ko.appendChild(t)})}function he(e){var t=!0,n=!0;if(e&&("updateSelectedIndex"in e&&(t=e.updateSelectedIndex),"saveZoomLevel"in e&&(n=e.saveZoomLevel)),Br.textContent=(100*Bi).toFixed(),Tr.disabled=Bi>=5,Or.disabled=.25>=Bi,t){for(var o=0;o<_r.childElementCount;o++){var r=parseFloat(_r.children[o].value);if(r===Bi){_r.selectedIndex=o;break}}_r.childElementCount===o&&(_r.selectedIndex=-1)}ta||(requestAnimationFrame(function(){var e=-1;Ii&&(e=parseInt(Ii.dataset.index,10)+1),Ci&&Ee(Ci,"zoom"),Nr.classList.contains("zooming")?Ur.addEventListener("transitionend",function t(){Ur.removeEventListener("transitionend",t),Nr.classList.remove("zooming"),-1!==e&&je(document.querySelector(".layer:nth-child("+e+")")),We()}):(-1!==e&&je(document.querySelector(".layer:nth-child("+e+")")),We()),ta=!1}),ta=!0),n&&(clearTimeout(ea),ea=setTimeout(function(){Zeplin.projectPrefs.set(xi.pid,"zoomLevel",Bi)},1e3))}function ye(e){if(Io.classList.toggle("hidden",!e),e){var t=230,n=48,o=206,r=32;if(e.vertical){var i=e.vertical,a=i.numberOfCols,s=i.columnWidth+i.gutterWidth,c=Math.min(t*i.columnWidth/s,o);Oo.style.width=Math.floor(c)+"px",Do.style.width=Math.ceil(t-c)+"px",Bo.textContent=O(i.columnWidth),_o.textContent=O(i.gutterWidth),Uo.textContent=O(a*i.columnWidth+(a-!i.guttersOnOutside)*i.gutterWidth),Ro.textContent=""+a}else Oo.removeAttribute("style"),Do.removeAttribute("style"),Uo.textContent="",Ro.textContent="";if(e.horizontal){var l=e.horizontal,d=l.rowHeight+l.gutterHeight,u=Math.min(n*l.rowHeight/d,r);qo.style.height=Math.floor(u)+"px",No.style.height=Math.ceil(n-u)+"px",qo.textContent=O(l.rowHeight),No.textContent=O(l.gutterHeight)}To.classList.toggle("v",!!e.vertical),To.classList.toggle("h",!!e.horizontal)}}function ve(e){if(si.removeAttribute("style"),ci.removeAttribute("style"),e){var t="rgba(238, 103, 35, 0.3)";if(e.vertical){var n=e.vertical,o=B(n.columnWidth,{unit:"px"}),r=B(n.columnWidth+n.gutterWidth,{unit:"px"}),i=n.numberOfCols,a=B(e.horizontalOffset+(n.guttersOnOutside?n.gutterWidth/2:0),{unit:"px"});si.style.maxWidth="calc(100% - 2 * "+a+")",si.style.width=B(i*n.columnWidth+(i-!n.guttersOnOutside)*n.gutterWidth,{unit:"px"}),si.style.margin="0 "+a,si.style.backgroundSize=r+" auto",si.style.backgroundImage="linear-gradient(to right, "+t+" 0px, "+t+" "+o+", transparent "+o+", transparent "+r+")"}if(e.horizontal){var s=e.horizontal,c=B(s.rowHeight,{unit:"px"}),l=B(s.rowHeight+s.gutterHeight,{unit:"px"});ci.style.padding="0 "+B(e.horizontalOffset,{unit:"px"}),ci.style.backgroundSize="100% "+l,ci.style.backgroundImage="linear-gradient(to bottom, "+t+" 0px, "+t+" "+c+", transparent "+c+", transparent "+l+")"}}}function Ee(e,t){var n=e.currentSnapshot;switch(t){case"initial":case"replace":di.src="",di.src=n.url;case"zoom":case"density":var o=20*Bi;Nr.style.width=B(n.width,{padding:240,unit:"px"}),Nr.style.height=B(n.height,{padding:120,unit:"px"}),Nr.style.backgroundImage="linear-gradient(to bottom, transparent 0px, transparent "+2*Bi+"px, #FFF "+2*Bi+"px, #FFF "+o+"px), linear-gradient(to right, #C8C3C7 0, #C8C3C7 "+2*Bi+"px, #FFF "+2*Bi+"px, #FFF "+o+"px)",Nr.style.backgroundPosition=window.innerWidth/2-151-Bi*n.width/window.devicePixelRatio/2+"px "+(-3*o+58)+"px",Nr.style.backgroundSize=o+"px "+o+"px",Ur.style.width=B(n.width,{unit:"px"}),Ur.style.height=B(n.height,{unit:"px"}),di.style.width=B(n.width,{unit:"px"}),di.style.height=B(n.height,{unit:"px"});case"layers":default:qe(),zr.innerHTML="",e.layers&&e.layers.forEach(le),ve(e.grid)}if("zoom"!==t)if(Ho.innerHTML="",Fo.innerHTML="",void 0===e.assets);else if(Array.isArray(e.assets)&&!e.assets.length||n.density!==En.density)Mo.classList.remove("loading"),Mo.classList.add("empty");else{Mo.classList.add("loading"),Mo.classList.remove("empty");var r={},i=[];e.assets.forEach(function(e){i.push(se(e,Ho)),e.contents.forEach(function(e){e.format in r?r[e.format]++:r[e.format]=1})}),Promise.race(i).then(function(){Mo.classList.remove("loading","empty")});for(var a in r)ae({aid:"all",format:a,count:r[a]},Fo)}}function Le(e,t){var n=!0,o=!1;t&&("updateURL"in t&&(n=t.updateURL),"resetTag"in t&&(o=t.resetTag)),window.CSS&&CSS.supports("grid-template-columns","repeat(auto-fill, 220px)")||(clearTimeout(zi),window.removeEventListener("resize",A)),o&&Ce(),"string"==typeof e?/^[0-9a-fA-F]{24}$/.test(e)?Si=parseInt(T(e).dataset.index,10):(Si=parseInt(e,10),isNaN(Si)&&(console.warn("Screen index is NaN"),Si=0)):Si=e,xn=Z(Si);for(var r=0;r<En.screens.length;r++)if(En.screens[r]._id===xn.dataset.id){Ci=En.screens[r];break}"dots"in Ci||R(Ci),Ln="screen",Vn.classList.remove("tabs"),Xn.disabled=0===Si,$n.disabled=Si===An.children.length-1,n&&(location.hash="pid="+En._id+"&sid="+Ci._id),Co.textContent=Ci.description,So.classList.toggle("hidden",!Ci.description),wo.setAttribute("datetime",Ci.updated||En.updated),fe(Ci),ye(Ci.grid),jo.innerHTML="",Li=new Set,ge(Ci),Ee(Ci,"initial"),E(),Qn.textContent=Ci.name,Qn.title=Ci.name,xn.classList.add("selected"),Vn.classList.remove("fetchend"),"layers"in Ci?(Vn.classList.remove("online","fetchstart","fetching"),Ao.classList.remove("loading")):(Vn.classList.add("fetchstart","fetching"),Ao.classList.add("loading"),Ao.classList.remove("empty"),Mo.classList.add("loading"),Mo.classList.remove("empty")),m(),g()}function xe(){return[].map.call(document.querySelectorAll(".tag.selected"),function(e){return e.dataset.tag})}function be(e){var t=En.screens.filter(function(e){return xe().reduce(function(t,n){return t&&e.tags&&-1!==e.tags.indexOf(n)},!0)});return e?t.sort(e):t}function Se(){if(An.innerHTML="",!En.screens||!En.screens.length)return document.querySelector(".projectOverview").classList.add("empty"),void(hi.disabled=!0);document.querySelector(".projectOverview").classList.remove("empty"),hi.disabled=!1;var e=be();e.length?(e.forEach(j),document.querySelector(".noIntersection").classList.add("hidden")):document.querySelector(".noIntersection").classList.remove("hidden"),v()}function Ce(){
[].forEach.call(document.querySelectorAll(".tag.selected"),function(e){e.classList.remove("selected")}),Se()}function we(){return!(oo.classList.contains("hidden")&&lo.classList.contains("hidden")&&Pr.classList.contains("hidden")&&pi.classList.contains("hidden"))}function ke(){if(pi.classList.remove("hidden"),gi.value="",gi.focus(),ji=JSON.parse(JSON.stringify(En.screens)).sort(Zeplin.compareByName),yi.classList.toggle("noScreen",!ji.length),fi.innerHTML="",ji.forEach(qt),ji.length){Zn=ji[0];var e=fi.querySelector(".screenSuggestion[data-id='"+Zn._id+"']");e.classList.add("selected"),e.scrollIntoView()}}function Ie(){Nt(),Le(Zn._id,{resetTag:!T(Zn._id)})}function Ze(){var e,t,n;ji.length&&(t=document.querySelector(".screenSuggestion[data-id='"+Zn._id+"']"),n=t.dataset.index,n<ji.length-1&&(t.classList.remove("selected"),n++,Zn=ji[n],e=document.querySelector(".screenSuggestion[data-id='"+Zn._id+"']"),e.classList.add("selected"),st(fi,e)||e.scrollIntoView(!1)))}function Te(){var e,t,n;ji.length&&(e=document.querySelector(".screenSuggestion[data-id='"+Zn._id+"']"),t=e.dataset.index,t>0&&(e.classList.remove("selected"),t--,Zn=ji[t],n=document.querySelector(".screenSuggestion[data-id='"+Zn._id+"']"),n.classList.add("selected"),st(fi,n)||n.scrollIntoView(!0)))}function Be(){Qn.style.width=getComputedStyle(Qn).width,Gn.addEventListener("mouseleave",_e)}function _e(){Gn.removeEventListener("mouseleave",_e),Qn.removeAttribute("style")}function Oe(){mi.classList.add("hidden"),lt(),Oi&&!wi&&(Oi.remove(),Di=null),qr.removeEventListener("scroll",We),wi=null,Oi=null,jr.innerHTML="",jr.scrollTop=0,Pr.classList.add("hidden")}function De(){if(Oi){var e=Oi;Oe(),Pe(e)}}function qe(){Ne(),Wr.classList.add("hidden"),bo.classList.add("resourceView"),bo.classList.remove("layerView"),Ur.removeEventListener("mouseover",Ue),Nr.removeEventListener("mousemove",Re),Ii&&(Ii.classList.remove("selected"),Ii=null,bn=null)}function Ne(){$r.classList.add("hidden"),ei.classList.add("hidden"),ni.classList.add("hidden"),ri.classList.add("hidden")}function Ue(e){if(e.stopPropagation(),!e.target.classList.contains("layer"))return Ne(),void Ur.classList.remove("measuring");Ur.classList.add("measuring"),_i=e.target;var t=bn.rect.x,n=t+bn.rect.width,o=bn.rect.y,r=o+bn.rect.height,i=Ci.layers[_i.dataset.index],a=i.rect.x,s=a+i.rect.width,c=i.rect.y,l=c+i.rect.height,d=!1,u=!1;if(Ne(),t>s)$r.style.left=B(s,{unit:"px"}),$r.style.width=B(t-s,{unit:"px"}),Qr.textContent=O(t-s),$r.classList.remove("hidden");else if(t>a&&s>n)$r.style.left=B(a,{unit:"px"}),$r.style.width=B(t-a,{unit:"px"}),Qr.textContent=O(t-a),$r.classList.remove("hidden"),ei.style.left=B(n,{unit:"px"}),ei.style.width=B(s-n,{unit:"px"}),ti.textContent=O(s-n),ei.classList.remove("hidden"),ni.style.left=B((t+n)/2,{unit:"px"}),ri.style.left=B((t+n)/2,{unit:"px"}),d=!0;else if(a>t&&n>s)$r.style.left=B(t,{unit:"px"}),$r.style.width=B(a-t,{unit:"px"}),Qr.textContent=O(a-t),$r.classList.remove("hidden"),ei.style.left=B(s,{unit:"px"}),ei.style.width=B(n-s,{unit:"px"}),ti.textContent=O(n-s),ei.classList.remove("hidden");else if(s>t&&n>s){$r.style.left=B(a,{unit:"px"}),$r.style.width=B(t-a,{unit:"px"}),Qr.textContent=O(t-a),$r.classList.remove("hidden");var m=s-t;m/window.devicePixelRatio>7&&(ni.style.left=B((s+t)/2,{unit:"px"}),ri.style.left=B((s+t)/2,{unit:"px"}),d=!0)}else if(a>t&&n>a){$r.style.left=B(t,{unit:"px"}),$r.style.width=B(a-t,{unit:"px"}),Qr.textContent=O(a-t),$r.classList.remove("hidden");var m=n-a;m/window.devicePixelRatio>7&&(ni.style.left=B((a+n)/2,{unit:"px"}),ri.style.left=B((a+n)/2,{unit:"px"}),d=!0)}else a>n&&(ei.style.left=B(n,{unit:"px"}),ei.style.width=B(a-n,{unit:"px"}),ti.textContent=O(a-n),ei.classList.remove("hidden"));if(d||(ni.style.left=B((a+s)/2,{unit:"px"}),ri.style.left=B((a+s)/2,{unit:"px"})),o>l)ni.style.top=B(l,{unit:"px"}),ni.style.height=B(o-l,{unit:"px"}),oi.textContent=O(o-l),ni.classList.remove("hidden");else if(o>c&&l>r)ni.style.top=B(c,{unit:"px"}),ni.style.height=B(o-c,{unit:"px"}),oi.textContent=O(o-c),ni.classList.remove("hidden"),ri.style.top=B(r,{unit:"px"}),ri.style.height=B(l-r,{unit:"px"}),ii.textContent=O(l-r),ri.classList.remove("hidden"),$r.style.top=B((o+r)/2,{unit:"px"}),ei.style.top=B((o+r)/2,{unit:"px"}),u=!0;else if(c>o&&r>l)ni.style.top=B(o,{unit:"px"}),ni.style.height=B(c-o,{unit:"px"}),oi.textContent=O(c-o),ni.classList.remove("hidden"),ri.style.top=B(l,{unit:"px"}),ri.style.height=B(r-l,{unit:"px"}),ii.textContent=O(r-l),ri.classList.remove("hidden");else if(l>o&&r>l){ni.style.top=B(c,{unit:"px"}),ni.style.height=B(o-c,{unit:"px"}),oi.textContent=O(o-c),ni.classList.remove("hidden");var p=l-o;p/window.devicePixelRatio>7&&($r.style.top=B((l+o)/2,{unit:"px"}),ei.style.top=B((l+o)/2,{unit:"px"}),u=!0)}else if(c>o&&r>c){ni.style.top=B(o,{unit:"px"}),ni.style.height=B(c-o,{unit:"px"}),oi.textContent=O(c-o),ni.classList.remove("hidden");var p=r-c;p/window.devicePixelRatio>7&&($r.style.top=B((c+r)/2,{unit:"px"}),ei.style.top=B((c+r)/2,{unit:"px"}),u=!0)}else c>r&&(ri.style.top=B(r,{unit:"px"}),ri.style.height=B(c-r,{unit:"px"}),ii.textContent=O(c-r),ri.classList.remove("hidden"));u||($r.style.top=B((c+l)/2,{unit:"px"}),ei.style.top=B((c+l)/2,{unit:"px"}))}function Re(e){var t=Ur.getBoundingClientRect(),n=bn.rect.x,o=n+bn.rect.width,r=bn.rect.y,i=r+bn.rect.height;Ne(),_i=null,e.clientX<t.left&&($r.style.left=0,$r.style.width=B(n,{unit:"px"}),Qr.textContent=O(n),$r.style.top=B((r+i)/2,{unit:"px"}),$r.classList.remove("hidden")),e.clientY<t.top&&(ni.style.top=0,ni.style.height=B(r,{unit:"px"}),oi.textContent=O(r),ni.style.left=B((n+o)/2,{unit:"px"}),ni.classList.remove("hidden")),e.clientX>t.right&&(ei.style.left=B(o,{unit:"px"}),ei.style.width=B(Ci.currentSnapshot.width-o,{unit:"px"}),ti.textContent=O(Ci.currentSnapshot.width-o),ei.style.top=B((r+i)/2,{unit:"px"}),ei.classList.remove("hidden")),e.clientY>t.bottom&&(ri.style.top=B(i,{unit:"px"}),ri.style.height=B(Ci.currentSnapshot.height-i,{unit:"px"}),ii.textContent=O(Ci.currentSnapshot.height-i),ri.style.left=B((n+o)/2,{unit:"px"}),ri.classList.remove("hidden"))}function Pe(e,t){if(e&&En.users){var n="string"==typeof e?document.querySelector(".dot[data-id='"+e+"']"):e;if(n){if(n===Oi)return void d(t);if(delete xi.did,delete xi.cmid,jr.innerHTML="",jr.scrollTop=0,Pr.classList.add("hidden"),Oi&&!wi&&Oi.remove(),Oi=n,de(Pr),Pr.classList.remove("left","right"),Pr.classList.add(fn[new Zeplin.Color(hn[Oi.dataset.color]).hexBase()],Oi.dataset.position),Fr.innerHTML="&nbsp",Kr.value="",Mr.classList.remove("hidden"),"undefined"===Oi.dataset.id)Pr.dataset.id="undefined",Mr.classList.add("composing"),setTimeout(function(){Kr.focus()},4);else{for(var o=0;o<Ci.dots.length;o++)if(Ci.dots[o]._id===Oi.dataset.id){wi=Ci.dots[o];break}Oi.classList.remove("highlight"),wi.comments.forEach(Xe),d(xi.cmids),Pr.dataset.id=wi._id,Je(),Mr.classList.remove("composing")}Pr.classList.remove("hidden"),la=Pr.getBoundingClientRect(),ze(),qr.addEventListener("scroll",We),"undefined"!==Oi.dataset.id&&setTimeout(function(){if(t){var e=(Ci.currentSnapshot.width*wi.x-qr.offsetWidth)/2+120,n=(Ci.currentSnapshot.height*wi.y-qr.offsetHeight)/2+60;"scrollTo"in Element.prototype?qr.scrollTo({left:e,top:n,behavior:"smooth"}):(qr.scrollLeft=e,qr.scrollTop=n),d(t)}else jr.lastElementChild.scrollIntoView()},200)}}}function Ae(e){var t=document.importNode(ra.content,!0);switch(t.querySelector(".borderPosition").textContent=e.position,t.querySelector(".borderThickness").textContent=O(e.thickness),dr.appendChild(t),e.fillType){case"color":K(e.color,dr);break;case"gradient":Y(e.gradient,dr)}}function je(e){if(e!==Ii){Ne(),Ii&&Ii.classList.remove("selected"),Ii=e,bn=Ci.layers[Ii.dataset.index];var t=bn.rect.width,n=bn.rect.height,o=bn.rect.x,r=bn.rect.y,i=bn.rotation,a=bn.opacity,s=bn.borderRadius,c=bn.blendMode;if(Ii.classList.add("selected"),Vr.style.top=B(r,{unit:"px"}),Jr.style.top=B(r+n-window.devicePixelRatio/Bi,{unit:"px"}),Xr.style.left=B(o,{unit:"px"}),Gr.style.left=B(o+t-window.devicePixelRatio/Bi,{unit:"px"}),Wr.classList.remove("hidden"),Ur.addEventListener("mouseover",Ue),Yo.textContent=bn.name,zo.textContent=O(o),Wo.textContent=O(r),Vo.textContent=O(t),Go.textContent=O(n),Jo.textContent=0===i?"":i+"°",Xo.textContent=1===a?"":Math.floor(100*a)+"%",$o.textContent=O(0===s?void 0:s),Qo.textContent="normal"===c?"":c,dr.innerHTML="",bn.borders.forEach(Ae),lr.classList.toggle("hidden",!bn.borders.length),mr.innerHTML="",bn.shadows.forEach(W),ur.classList.toggle("hidden",!bn.shadows.length),bn.blur?(gr.textContent=bn.blur.type,fr.textContent=O(bn.blur.radius),pr.classList.remove("hidden")):pr.classList.add("hidden"),"text"===bn.type)Ko.classList.add("textLayer"),er.textContent=bn.fontFace,tr.textContent=O(bn.fontSize,"text"),nr.textContent=O(bn.lineHeight,"text"),or.textContent=O(bn.letterSpacing,"text"),rr.innerHTML="",bn.fills.length?bn.fills.forEach(function(e){z(bn.type,e)}):bn.color&&K(bn.color,rr),ar.textContent=bn.content;else if(Ko.classList.remove("textLayer"),bn.fills.length?(cr.innerHTML="",bn.fills.forEach(function(e){z(bn.type,e)}),sr.classList.remove("hidden")):sr.classList.add("hidden"),bn.exportable){for(var l=0;l<Ci.assets.length;l++)if(Ci.assets[l].layerName.toUpperCase()===bn.name.toUpperCase()){Zi=Ci.assets[l];break}if(Zi){var d=re(Zi.contents);oe(d).then(function(e){yr.className=e.lightness}),yr.src=d.url,yr.srcset=ie(Zi.contents),vr.textContent=Zi.displayName,vr.title=Zi.displayName;for(var u={},l=0;l<Zi.contents.length;l++){var m=Zi.contents[l];m.format in u?u[m.format]++:u[m.format]=1}Er.innerHTML="";for(var p in u)ae({aid:Zi._id,format:p,count:u[p]},Er);hr.classList.remove("hidden")}else hr.classList.add("hidden")}else hr.classList.add("hidden");Fe(),bo.classList.remove("resourceView"),bo.classList.add("layerView")}}function Me(){vn=new CodeMirror(document.getElementById("layerStyle"),{lineSeparator:"\n",theme:"theme-zeplin",indentUnit:2,lineWrapping:!0,lineNumbers:!0,lineNumberFormatter:function(){return"•"},readOnly:!0,cursorBlinkRate:-1,viewportMargin:!0,styleSelectedText:!0})}function He(e){switch(e){case"sass":return"sass";case"scss":return"text/x-scss";case"less":return"text/x-less";case"stylus":return"stylus";case"css":default:return"css"}}function Fe(){if("web"===En.type&&bn){var e=new Zeplin.Layer(bn);Zeplin.projectPrefs.get(xi.pid,"webStyleExportType").then(function(t){Zeplin.projectPrefs.get(xi.pid,"webShowDimensions").then(function(n){Zeplin.projectPrefs.get(xi.pid,"webUnitlessLineHeight").then(function(o){var r=Zeplin.CSSUtil.toStyleRule(t,e.toCSS(Sn,n,o),Hi);vn.setOption("mode",He(t)),vn.setValue(r),Zr.value=r,vn.refresh()})})})}}function Ke(){Nr.classList.add("noteMode"),ca=!0}function Ye(){Nr.classList.remove("noteMode"),ca=!1}function ze(){var e,t,n=Oi.getBoundingClientRect(),o=!1;"left"===Oi.dataset.position?(n.left>window.innerWidth-280&&(o=!0),n.left<la.width+20?(o=!0,e=6):n.left-7>window.innerWidth?(o=!0,e=window.innerWidth-la.width-6):(o=o||!1,e=n.left-la.width-13)):(n.right<0&&(o=!0),n.right+la.width+20>window.innerWidth?(o=!0,e=window.innerWidth-la.width-6):n.left<-27?(o=!0,e=6):(o=o||!1,e=n.right+13)),n.top<92?(o=!0,t=66):n.top+la.height-18>window.innerHeight?(o=!0,t=window.innerHeight-la.height-6):(o=o||!1,t=n.top+n.height/2-38),Pr.classList.toggle("overflown",o),Pr.style.webkitTransform="translate3d("+e.toFixed()+"px, "+t.toFixed()+"px, 0)",Pr.style.transform="translate("+e.toFixed()+"px, "+t.toFixed()+"px)"}function We(){Oi&&!ua&&(requestAnimationFrame(function(){ze(),ua=!1}),ua=!0)}function Ve(e){return e.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;").replace(/'/gm,"&#39;")}function Ge(e){return da=[],ma.link(e).replace(/#(\w+)/g,function(e,t){for(var n=0;n<En.colors.length;n++){var o=En.colors[n];if(o.name===t)return'<span class="color">'+e+'<span class="colorPreview" style="background-color:'+new Zeplin.Color(o).toCSS()+'"></span></span>'}if(/#[\da-f]{6}/i.test(e)){for(var n=0;n<En.colors.length;n++){var o=En.colors[n];if(new Zeplin.Color(o).toHexString()===e.toLowerCase())return'<span class="color">#'+o.name+'<span class="colorPreview" style="background-color:'+e+'"></span></span>'}return'<span class="color">'+e+'<span class="colorPreview" style="background-color:'+e+'"></span></span>'}return e}).replace(kn,function(e){return'<span class="user'+(qi.test(e)?" self":"")+'">'+e+"</span>"}).replace(/{{link:(\d+)}}/g,function(e,t){return da[parseInt(t,10)]})}function Je(){Hr.textContent=jr.lastElementChild.classList.contains("commentOwner")?"POST":"REPLY"}function Xe(e,t){delete e.status;var n=document.importNode(pa.content,!0),o=n.querySelector(".comment");$e(o,e),o.dataset.index=t,jr.appendChild(n);var r=jr.lastElementChild,i=r.querySelector(".commentNote"),a=r.querySelector(".commentMirror");return i.addEventListener("input",function(e){nt(e,a,i,r)}),i.addEventListener("keyup",function(e){switch(e.keyCode){case Zeplin.KEY_CODE.ArrowLeft:case Zeplin.KEY_CODE.ArrowRight:ct(i)}}),i.addEventListener("keydown",function(e){switch(e.keyCode){case Zeplin.KEY_CODE.ENTER:mi.classList.contains("hidden")||(e.preventDefault(),ot(e,i,a));break;case Zeplin.KEY_CODE.ArrowDown:mi.classList.contains("hidden")||(e.preventDefault(),rt(e));break;case Zeplin.KEY_CODE.ArrowUp:mi.classList.contains("hidden")||(e.preventDefault(),it(e))}}),r}function $e(e,t){for(var n,o=0;o<En.users.length;o++)if(En.users[o].user._id===t.author){n=En.users[o].user;break}Zeplin.setGravatar(e.querySelector(".commentAuthorImage"),n&&n.email,{size:36}),e.querySelector(".commentAuthorName").textContent=n?n.username:"Anonymous",e.dataset.id=t._id,t.author&&t.author!==Zeplin.user._id?e.classList.remove("commentOwner"):e.classList.add("commentOwner");var r=new Date(t.created),i=new Date(t.updated);e.querySelector(".commentCreated").setAttribute("datetime",r),e.querySelector(".commentMirror").innerHTML=Ge(Ve(t.note)),e.querySelector(".commentEdited").setAttribute("datetime",i-r>3e5?i:"")}function Qe(){var e=Kr.value.trim();if(e){var t=En._id,n=Ci._id,o=wi._id,r={author:Zeplin.user._id,note:e,created:Date.now(),updated:Date.now()},i=Xe(r);ze(),i.style.opacity=.5,i.scrollIntoView(),Je(),Mr.classList.remove("composing"),fetch(Zeplin.urls.baseURL+"/projects/"+t+"/screens/"+n+"/dots/"+o+"/comments",{method:"POST",headers:Zeplin.headers,body:JSON.stringify({note:e})}).then(function(e){return e.json().then(function(t){if(e.ok)return t;throw Zeplin.createError(e.status,t)})}).then(function(e){wi.comments.push(e),Fr.innerHTML="&nbsp;",Kr.value="",i.dataset.id=e._id,i.removeAttribute("style"),mixpanel.track("Created comment")})["catch"](function(e){console.error(e),e instanceof ServerError?(i.remove(),Mr.classList.add("composing"),Kr.focus(),Zeplin.createDialog({title:e.title,message:e.message})):e instanceof ClientError?Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status?(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html")):(i.remove(),Mr.classList.add("composing"),Kr.focus())}}}):(i.remove(),Mr.classList.add("composing"),Kr.focus(),Zeplin.createDialog())})}}function et(e){var t=e.querySelector(".commentMirror"),n=e.querySelector(".commentNote"),o=n.value.trim();if(o){if(ki.note===o)return t.innerHTML=Ge(Ve(ki.note)),e.classList.remove("editing"),void Mr.classList.remove("hidden");var r=En._id,i=Ci._id,a=wi._id,s=e.dataset.id;e.classList.remove("editing"),e.style.opacity=.5,Mr.classList.remove("hidden"),t.innerHTML=Ge(Ve(o)),fetch(Zeplin.urls.baseURL+"/projects/"+r+"/screens/"+i+"/dots/"+a+"/comments/"+s+"/note",{method:"PUT",headers:Zeplin.headers,body:JSON.stringify({note:o})}).then(function(e){return e.ok?void 0:e.json().then(function(t){throw Zeplin.createError(e.status,t)})}).then(function(){ki.note=o,$e(e,ki),e.removeAttribute("style"),mixpanel.track("Edited comment")})["catch"](function(t){console.error(t),t instanceof ServerError?(e.removeAttribute("style"),e.classList.add("editing"),Mr.classList.add("hidden"),n.focus(),Zeplin.createDialog({title:t.title,message:t.message})):t instanceof ClientError?Zeplin.createDialog({title:t.title,message:t.message,done:{name:"OK",cb:function(){401===t.status?(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html")):(e.removeAttribute("style"),e.classList.add("editing"),Mr.classList.add("hidden"),n.focus())}}}):(e.removeAttribute("style"),e.classList.add("editing"),Mr.classList.add("hidden"),n.focus(),Zeplin.createDialog())})}}function tt(e){var t=En._id,n=Ci._id,o=wi._id,r=e.dataset.id;1===wi.comments.length?(Pr.classList.add("hidden"),Oi.classList.add("hidden")):(e.style.height=getComputedStyle(e).height,e.style.height=0,e.style.padding="0 6px 0 12px"),fetch(Zeplin.urls.baseURL+"/projects/"+t+"/screens/"+n+"/dots/"+o+"/comments/"+r,{method:"DELETE",headers:Zeplin.headers}).then(function(e){return e.ok?void 0:e.json().then(function(t){throw Zeplin.createError(e.status,t)})}).then(function(){e.remove();for(var t=0;t<wi.comments.length;t++)if(wi.comments[t]._id===r){wi.comments.splice(t,1);break}if(wi.comments.length)Je(),ze();else{for(var n=0;n<Ci.dots.length;n++)if(Ci.dots[n]._id===o){Ci.dots.splice(n,1);break}Oi.remove(),wi=null,Oi=null,jr.innerHTML="",jr.scrollTop=0}mixpanel.track("Deleted comment")})["catch"](function(t){console.error(t),t instanceof ServerError?(1===wi.comments.length?(Pr.classList.remove("hidden"),Oi.classList.remove("hidden")):e.removeAttribute("style"),Zeplin.createDialog({title:t.title,message:t.message})):t instanceof ClientError?Zeplin.createDialog({title:t.title,message:t.message,done:{name:"OK",cb:function(){401===t.status?(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html")):1===wi.comments.length?(Pr.classList.remove("hidden"),Oi.classList.remove("hidden")):e.removeAttribute("style")}}}):(1===wi.comments.length?(Pr.classList.remove("hidden"),Oi.classList.remove("hidden")):e.removeAttribute("style"),Zeplin.createDialog())})}function nt(e,t,n,o){return t.innerHTML=Ve(n.value)+"&nbsp;",e.target.value?(o.appendChild(mi),void ct(e.target)):(In=null,mi.classList.add("hidden"),void lt())}function ot(e,t,n){e.preventDefault();var o=Ri.substr(0,Ri.lastIndexOf("@"))+"@"+In.user.username;t.value=o+" "+(Pi||""),n.innerHTML=Ve(t.value)+"&nbsp;",t.setSelectionRange(o.length+1,o.length+1),mi.classList.add("hidden"),lt()}function rt(e){if(Ui.length>0){var t=document.querySelector(".suggestedUser[data-id='"+In.user._id+"']").dataset.index;mi.classList.contains("hidden")||e.preventDefault(),t<Ui.length-1&&(document.querySelector(".suggestedUser.selected").classList.remove("selected"),t++,at(Ui[t],!1))}}function it(e){if(Ui.length>0){var t=document.querySelector(".suggestedUser[data-id='"+In.user._id+"']").dataset.index;mi.classList.contains("hidden")||e.preventDefault(),t>0&&(document.querySelector(".suggestedUser.selected").classList.remove("selected"),t--,at(Ui[t],!0))}}function at(e,t){var n;In=e,n=document.querySelector(".suggestedUser[data-id='"+In.user._id+"']"),st(mi,n)||n.scrollIntoView(t),n.classList.add("selected")}function st(e,t){var n=e.getBoundingClientRect(),o=t.getBoundingClientRect();return n.top<o.top&&n.bottom>o.bottom}function ct(e){var t;if(e.selectionStart!==e.selectionEnd)return mi.classList.add("hidden"),void lt();var n=e.value.substring(0,e.selectionStart),o=n.length-n.split("").reverse().join("").search(/\W/)-1;return Ri=n,"@"!==e.value.charAt(o)?(mi.classList.add("hidden"),void lt()):(t=e.value.substr(e.selectionStart).search(/\W/),t=t>-1?e.selectionStart+t:void 0,mi.classList.add("hidden"),lt(),t?(Ai=e.value.substring(o+1,t),Pi=e.value.substr(t+1).trim()):(Ai=e.value.substring(o+1),Pi=""),"everyone"===Ai&&(Ai=""),void w(Ai))}function lt(){Ai=null,Ui=[],ui.innerHTML=""}function dt(e,t){var n=document.createElement("div");n.classList.add("toast",t),n.textContent=e,document.body.appendChild(n),setTimeout(function(){n.classList.add("show"),setTimeout(function(){n.addEventListener("transitionend",function(){n.remove()}),n.classList.remove("show")},3e3)},50)}function ut(e){var t="#text"===e.target.nodeName?e.target.nextElementSibling?e.target.nextElementSibling:e.target.parentElement:e.target,n=(t.id?t.id:t.className).replace(/[A-Z]/g,function(e){return" "+e.toLowerCase()}).replace(/^./,function(e){return e.toUpperCase()}).replace(/ with label$/,"");n&&-1===["Sidebar row","No border","No screen colors","No screen assets","No color message"].indexOf(n)&&mixpanel.track("Copied something from "+this.id.replace(/[A-Z]/g,function(e){return" "+e.toLowerCase()}),{type:n})}function mt(){var e=document.querySelector(".deleteColorContainer");e&&e.remove()}function pt(e,t,n){for(var o=En.colors.length,r=0;o>r;r++){var i=new Zeplin.Color(En.colors[r]),a=i.toHexString().indexOf("%")>-1?i.toHexString().split(/\s/)[0].substr(1):i.toHexString().substr(1);if(t!==En.colors[r]._id&&e===a&&n.a===i.a)return i.name}return!1}function gt(e,t,n){for(var o=En.colors.length,r=0;o>r;r++){var i=new Zeplin.Color(En.colors[r]);if(t!==En.colors[r]._id&&parseInt(e)/100===i.a&&n.toHexString().split(/\s/)[0]===i.toHexString().split(/\s/)[0])return i.name}return!1}function ft(e){return"//\n//  UIColor+"+po.value+"."+e+"\n//  "+En.name+"\n//\n//  Generated on Zeplin. (by "+Zeplin.user.username+" on "+(new Date).toLocaleDateString()+").\n//  Copyright (c) 2014 __MyCompanyName__. All rights reserved.\n//\n\n"}function ht(e){return"//\n//  NSColor+"+ho.value+"."+e+"\n//  "+En.name+"\n//\n//  Generated on Zeplin. (by "+Zeplin.user.username+" on "+(new Date).toLocaleDateString()+").\n//  Copyright (c) 2014 __MyCompanyName__. All rights reserved.\n//\n\n"}function yt(){var e=ft("h")+"#import <UIKit/UIKit.h>\n\n@interface UIColor ("+po.value+")\n\n"+En.colors.reduce(function(e,t){return e+"+ (UIColor *)"+go.value+"_"+t.name.charAt(0).toLowerCase()+t.name.substr(1)+"Color;\n"},"")+"\n@end",t=ft("m")+'#import "UIColor+'+po.value+'.h"\n\n@implementation UIColor ('+po.value+")\n\n"+En.colors.reduce(function(e,t){var n=parseFloat(t.a.toFixed(1))===parseFloat(t.a.toFixed(2))?t.a.toFixed(1):t.a.toFixed(2);return e+"+ (UIColor *)"+En.prefix+"_"+t.name.charAt(0).toLowerCase()+t.name.substr(1)+"Color {\n    return [UIColor colorWithRed:"+t.r.toFixed(1)+"f / 255.0f\n                           green:"+t.g.toFixed(1)+"f / 255.0f\n                            blue:"+t.b.toFixed(1)+"f / 255.0f\n                           alpha:"+n+"f];\n}\n\n"},"")+"@end",n=new JSZip;n.file("UIColor+"+po.value+".h",e),n.file("UIColor+"+po.value+".m",t),ee({data:URL.createObjectURL(n.generate({type:"blob"})),name:"colors_"+En.name+".zip"}),mixpanel.track("Generated iOS color category")}function vt(){var e=ht("h")+"#import <Cocoa/Cocoa.h>\n\n@interface NSColor ("+po.value+")\n\n"+En.colors.reduce(function(e,t){return e+"+ (NSColor *)"+yo.value+"_"+t.name.charAt(0).toLowerCase()+t.name.substr(1)+"Color;\n"},"")+"\n@end",t=ht("m")+'#import "NSColor+'+po.value+'.h"\n\n@implementation NSColor ('+po.value+")\n\n"+En.colors.reduce(function(e,t){var n=parseFloat(t.a.toFixed(1))===parseFloat(t.a.toFixed(2))?t.a.toFixed(1):t.a.toFixed(2),o="";return o=t.r===t.g&&t.g===t.b?"+ (NSColor *)"+En.prefix+"_"+t.name.charAt(0).toLowerCase()+t.name.substr(1)+"Color {\n    return [NSColor colorWithCalibratedWhite:"+t.r.toFixed(1)+"f / 255.0f alpha:"+n+"f];\n}\n\n":"+ (NSColor *)"+En.prefix+"_"+t.name.charAt(0).toLowerCase()+t.name.substr(1)+"Color {\n    return [NSColor colorWithCalibratedRed:"+t.r.toFixed(1)+"f / 255.0f green:"+t.g.toFixed(1)+"f / 255.0f blue:"+t.b.toFixed(1)+"f / 255.0f alpha:"+n+"f];\n}\n\n",e+o},"")+"@end",n=new JSZip;n.file("NSColor+"+ho.value+".h",e),n.file("NSColor+"+ho.value+".m",t),ee({data:URL.createObjectURL(n.generate({type:"blob"})),name:"colors_"+En.name+".zip"}),mixpanel.track("Generated OSX color category")}function Et(){var e=vo.dataset.exportType,t={css:{prefix:"    --",midfix:": ",suffix:";\n"},sass:{prefix:"$",midfix:": ",suffix:"\n"},scss:{prefix:"$",midfix:": ",suffix:";\n"},less:{prefix:"@",midfix:": ",suffix:";\n"},stylus:{prefix:"",midfix:" = ",suffix:"\n"}},n="/*\n"+yn+"*/\n\n"+("css"===e?":root {\n":"")+En.colors.reduce(function(n,o){return n+t[e].prefix+o.name.replace(/([A-Z])/g,function(e,t,n){return(n?"-":"")+e.toLowerCase()})+t[e].midfix+new Zeplin.Color(o).toCSS()+t[e].suffix},"")+("css"===e?"}":"");ee({data:URL.createObjectURL(new Blob([n],{type:"text/"+e})),name:"colors."+e}),mixpanel.track("Generated web colors",{type:e})}function Lt(){var e='<?xml version="1.0" encoding="utf-8"?>\n<!--\n'+yn+"-->\n\n<resources>\n"+En.colors.reduce(function(e,t){return e+'    <color name="'+t.name.replace(/([A-Z])/g,function(e,t,n){return(n?"_":"")+e.toLowerCase()})+'">'+new Zeplin.Color(t).toARGBHexString()+"</color>\n"},"")+"</resources>";ee({data:URL.createObjectURL(new Blob([e],{type:"application/xml"})),name:"colors.xml"}),mixpanel.track("Generated Android color xml")}function xt(e){return new Promise(function(t,n){for(var o=0;o<En.users.length;o++)if(En.users[o].user._id===e)return t(En.users[o]);n("User "+e+" does not exist.")})}function bt(e){return new Promise(function(t,n){for(var o=0;o<En.users.length;o++)if(En.users[o].user._id===e)return t(En.users.splice(o,1)[0]);n("User "+e+" does not exist.")})}function St(e){return new Promise(function(t,n){for(var o=0;o<En.colors.length;o++)if(En.colors[o]._id===e)return t(En.colors[o]);n("Color "+e+" does not exist.")})}function Ct(e){return new Promise(function(t,n){for(var o=0;o<En.colors.length;o++)if(En.colors[o]._id===e)return t(En.colors.splice(o,1)[0]);n("Color "+e+" does not exist.")})}function wt(e){return new Promise(function(t,n){for(var o=0;o<En.screens.length;o++)if(En.screens[o]._id===e)return t(En.screens[o]);n("Screen "+e+" does not exist.")})}function kt(e){return new Promise(function(t,n){for(var o=0;o<En.screens.length;o++)if(En.screens[o]._id===e)return t(En.screens.splice(o,1)[0]);n("Screen "+e+" does not exist.")})}function It(e,t){return new Promise(function(n,o){for(var r=0;r<e.dots.length;r++)if(e.dots[r]._id===t)return n(e.dots[r]);o("Dot "+t+" does not exist.")})}function Zt(e,t){return new Promise(function(n,o){for(var r=0;r<e.dots.length;r++)if(e.dots[r]._id===t)return n(e.dots.splice(r,1)[0]);o("Dot "+t+" does not exist.")})}function Tt(e,t){return new Promise(function(n,o){for(var r=0;r<e.comments.length;r++)if(e.comments[r]._id===t)return n(e.comments[r]);o("Comment "+t+" does not exist.")})}function Bt(e,t){return new Promise(function(n,o){for(var r=0;r<e.comments.length;r++)if(e.comments[r]._id===t)return n(e.comments.splice(r,1)[0]);o("Comment "+t+" does not exist.")})}function _t(e){window.Notification&&"granted"===Notification.permission&&Zeplin.userPrefs.get("notificationStatus").then(function(t){if(t){var n=new Notification(e.title,{body:e.body,icon:"https://secure.gravatar.com/avatar/"+md5(e.notifier.email)+"?s=160",name:0});n.addEventListener("show",function(){setTimeout(n.close.bind(n),5e3)}),"handler"in e&&n.addEventListener("click",e.handler)}})}function Ot(e){En.name=e,E(),jn.value=e}function Dt(e){for(var t=[],n=[],o=[],r=[],i=En.screens.length,a=JSON.parse(JSON.stringify(En.screens)),s=0;i>s;s++)Ut(a[s].name,e,!0)?t.push(a[s]):Rt(a[s],e)?n.push(a[s]):Pt(a[s],e)?o.push(a[s]):Ut(a[s].name,e,!1)&&r.push(a[s]);if(ji=t.sort(Zeplin.compareByName).concat(n.sort(Zeplin.compareByName)).concat(o.sort(Zeplin.compareByName)).concat(r.sort(Zeplin.compareByName)),yi.classList.toggle("noScreen",!ji.length),fi.innerHTML="",ji.forEach(qt),ji.length){Zn=ji[0];var c=fi.querySelector(".screenSuggestion[data-id='"+Zn._id+"']");c.classList.add("selected"),c.scrollIntoView()}}function qt(e,t){var n=document.importNode(ha.content,!0),o=n.querySelector(".screenSuggestion");o.dataset.id=e._id,o.dataset.index=t,n.querySelector(".screenName").textContent=e.name,n.querySelector(".tagName").textContent=e.filterTag||"",fi.appendChild(n)}function Nt(){gi.value="",gi.blur(),fi.innerHTML="",pi.classList.add("hidden")}function Ut(e,t,n){return n?e.toLowerCase().substr(0,t.length)===t.toLowerCase():e.indexOf(t)>-1}function Rt(e,t){for(var n=e.name.split(/\W/),o=1;o<n.length;o++)if(Ut(n[o],t,!0))return!0;return!1}function Pt(e,t){var n;if(!e.tags)return!1;n=e.tags;for(var o=0;o<n.length;o++)if(Ut(n[o],t,!0))return e.filterTag=n[o],!0;return!1}function At(e){e.target.parentElement.classList.contains("added")?jt(e.target.parentElement):Mt(e)}function jt(e){"colorPalette"===e.parentElement.id?e.classList.add("hidden"):(e.querySelector(".colorName").classList.add("hidden"),e.classList.remove("added")),fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/colors/"+e.dataset.id,{method:"DELETE",headers:Zeplin.headers}).then(function(e){return e.ok?void 0:e.json().then(function(t){throw Zeplin.createError(e.status,t)})}).then(function(){Mi=!0,Ft(e.dataset.id)})["catch"](function(t){console.error(t),Mi=!0,t instanceof ServerError?("colorPalette"===e.parentElement.id?e.classList.remove("hidden"):(e.querySelector(".colorName").classList.remove("hidden"),e.classList.add("added")),Zeplin.createDialog({title:t.title,message:t.message})):t instanceof ClientError?Zeplin.createDialog({title:t.title,message:t.message,done:{name:"OK",cb:function(){401===t.status?(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html")):"colorPalette"===e.parentElement.id?e.classList.remove("hidden"):(e.querySelector(".colorName").classList.remove("hidden"),e.classList.add("added"))}}}):("colorPalette"===e.parentElement.id?e.classList.remove("hidden"):(e.querySelector(".colorName").classList.remove("hidden"),e.classList.add("added")),Zeplin.createDialog())})}function Mt(e){var t=e.target.parentElement,n=new Zeplin.Color(JSON.parse(t.dataset.rgbcolor)),o={r:n.r,g:n.g,b:n.b,a:n.a,name:Yt(n)};t.querySelector(".colorName").textContent=o.name,t.classList.add("added"),fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/colors",{method:"POST",headers:Zeplin.headers,body:JSON.stringify(o)}).then(function(e){return e.json().then(function(t){if(e.ok)return t;throw Zeplin.createError(e.status,t)})}).then(function(e){Mi=!0,o._id=e._id,Ht(o)})["catch"](function(e){console.error(e),Mi=!0,e instanceof ServerError?(t.querySelector(".colorName").textContent="",t.classList.remove("added"),Zeplin.createDialog({title:e.title,message:e.message})):e instanceof ClientError?Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status?(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html")):(t.querySelector(".colorName").textContent="",t.classList.remove("added"))}}}):(t.querySelector(".colorName").textContent="",t.classList.remove("added"),Zeplin.createDialog())})}function Ht(e){En.colors.push(e),F(e);var t=document.querySelectorAll(".color[data-color='"+new Zeplin.Color(e).toHexString()+"']");[].forEach.call(t,function(t){t.dataset.id=e._id,t.querySelector(".colorName").textContent=e.name,t.querySelector(".colorName").classList.remove("hidden"),t.classList.add("added")}),r(),Fe(),De()}function Ft(e){Ct(e).then(function(e){var t=bo.querySelectorAll(".color[data-id='"+e._id+"']");if([].forEach.call(t,function(e){e.querySelector(".colorName").textContent="",e.classList.remove("added")}),En.colors.length){var n=Lo.querySelector(".color[data-id='"+e._id+"']");n&&n.remove()}else Lo.innerHTML=""}).then(r).then(Fe).then(De)["catch"](function(e){console.warn(e)})}function Kt(e,t){St(e).then(function(n){var o=Lo.querySelector(".color[data-id='"+e+"']");if("name"in t){var r=document.querySelectorAll(".color[data-id='"+e+"']");[].forEach.call(r,function(e){e.querySelector(".colorName").textContent=t.name,e.classList.add("added")}),o.querySelector(".colorName").value=t.name,
n.name=t.name}if("r"in t||"g"in t||"b"in t||"a"in t){var r=bo.querySelectorAll(".color[data-id='"+e+"']");[].forEach.call(r,function(e){e.querySelector(".colorName").textContent="",e.classList.remove("added"),e.removeAttribute("data-id")}),n.r="r"in t?t.r:n.r,n.g="g"in t?t.g:n.g,n.b="b"in t?t.b:n.b,n.a="a"in t?t.a:n.a;var i=new Zeplin.Color(n),a=i.toHexString().split("   ");r=bo.querySelectorAll(".color[data-color='"+i.toHexString()+"']"),[].forEach.call(r,function(t){t.querySelector(".colorName").textContent=n.name,t.classList.add("added"),t.dataset.id=e}),o.dataset.color=i.toHexString(),o.dataset.rgbcolor=JSON.stringify(n),o.querySelector(".colorPreview").style.backgroundColor=i.toCSS(),o.querySelector(".colorHex").value=a[0].slice(1),o.querySelector(".colorAlpha").value=Math.round(100*i.a),o.querySelector(".colorRGB").textContent=i.toRGBAString()}}).then(r).then(Fe).then(De)["catch"](function(e){console.warn(e)})}function Yt(e){return e.a<1?zt(e):Vt(e.generateName(En.type))}function zt(e){for(var t=En.colors.length,n=0;t>n;n++)if(En.colors[n].r===e.r&&En.colors[n].g===e.g&&En.colors[n].b===e.b){var o=En.colors[n].name.length,r=parseInt(En.colors[n].name.substr(o-2));return Vt(r&&r===Math.round(100*En.colors[n].a)?Wt(En.colors[n].name.substr(0,o-2),Math.round(100*e.a),En.type):Wt(En.colors[n].name,Math.round(100*e.a),En.type))}return Vt(Wt(e.generateName(En.type),Math.round(100*e.a),En.type))}function Wt(e,t,n){switch(n){case"ios":case"osx":return e+t;case"web":return e+("-"===e[e.length-1]?"":"-")+("string"==typeof t?t.toLowerCase():t);case"android":return e+("_"===e[e.length-1]?"":"_")+("string"==typeof t?t.toLowerCase():t)}}function Vt(e){for(var t=e,n=0,o=["One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten"];Gt(t);)n++,t=Wt(e,o[n],En.type);return n>0?Wt(e,o[n],En.type):t}function Gt(e,t){for(var n=En.colors.length,o=0;n>o;o++)if(!t&&En.colors[o].name===e||t&&t!==En.colors[o]._id&&En.colors[o].name===e)return!0;return!1}function Jt(e,t,n,o,r){var i=n.toHexString();if("name"in t)o.querySelector(".colorName").value=t.name;else if("a"in t)o.querySelector(".colorAlpha").value=Math.round(100*t.a);else{var a=new Zeplin.Color(t);o.querySelector(".colorHex").value=a.toHexString().split(" ")[0].slice(1)}fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/colors/"+e,{method:"PUT",headers:Zeplin.headers,body:JSON.stringify(t)}).then(function(e){return e.ok?void 0:e.json().then(function(t){throw Zeplin.createError(e.status,t)})}).then(function(){Kt(e,t),r.target.blur()})["catch"](function(e){console.error(e),e instanceof ServerError?(o.querySelector(".colorName").value=n.name,o.querySelector(".colorHex").value=i.substr(1),o.querySelector(".colorAlpha").value=n.a?100*n.a:100,Zeplin.createDialog({title:e.title,message:e.message})):e instanceof ClientError?Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status?(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html")):(o.querySelector(".colorName").value=n.name,o.querySelector(".colorHex").value=i[0].slice(1),o.querySelector(".colorAlpha").value=i[1]?i[1].replace("%",""):100)}}}):(o.querySelector(".colorName").value=n.name,o.querySelector(".colorHex").value=i[0].slice(1),o.querySelector(".colorAlpha").value=i[1]?i[1].replace("%",""):100,Zeplin.createDialog())})}function Xt(e){var t={};return e=e.replace("#",""),t.r=parseInt(e.substring(0,2),16),t.g=parseInt(e.substring(2,4),16),t.b=parseInt(e.substring(4,6),16),t}function $t(e,t,o){fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/users/"+e+"/role",{method:"PUT",headers:Zeplin.headers,body:JSON.stringify({role:t})}).then(function(e){return e.ok?void 0:e.json().then(function(t){throw Zeplin.createError(e.status,t)})}).then(function(){o.dataset.role=t,Qt(),xt(e).then(function(e){e.role=t}).then(n)})["catch"](nn)}function Qt(){so.querySelector(".memberMenuOpen")&&(ya.classList.add("hidden"),ya.querySelector(".assign").classList.remove("admin"),ya.querySelector(".assign").classList.remove("user"),so.querySelector(".memberMenuOpen").classList.remove("memberMenuOpen"))}function en(e){fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/users/"+e,{method:"DELETE",headers:Zeplin.headers}).then(function(e){return e.ok?void 0:e.json().then(function(t){throw Zeplin.createError(e.status,t)})}).then(function(){Zeplin.getUserInfo().then(function(t){bt(e).then(function(){e===t._id&&(Oe(),location.replace("projects.html")),n(En.users)}).then(De)["catch"](function(e){console.warn(e)})})})["catch"](nn)}function tn(e){fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/users/"+e+"/ownership",{method:"POST",headers:Zeplin.headers}).then(function(e){return e.ok?void 0:e.json().then(function(t){throw Zeplin.createError(e.status,t)})}).then(function(){Zeplin.getUserInfo().then(function(t){xt(t._id).then(function(t){return t.role="admin",document.body.dataset.userRole="admin",xt(e)}).then(function(e){e.role="owner"}).then(n)["catch"](function(e){console.warn(e)})})})["catch"](nn)}function nn(e){console.error(e),e instanceof ServerError?Zeplin.createDialog({title:e.title,message:e.message}):e instanceof ClientError?Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status&&(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html"))}}}):Zeplin.createDialog()}function on(e,t){fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/screens/"+e,{method:"PUT",headers:Zeplin.headers,body:JSON.stringify({name:t.value})}).then(function(e){return e.ok?void 0:e.json().then(function(t){throw Zeplin.createError(e.status,t)})}).then(function(){wt(e).then(function(e){e.name=t.value})})["catch"](function(e){console.error(e),e instanceof ServerError?Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){var e=document.querySelector("dialog paper-ripple");e.addEventListener("transitionend",function n(){e.removeEventListener("transitionend",n),t.focus(),t.setSelectionRange(t.value.length,t.value.length)})}}}):e instanceof ClientError?Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status&&(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html"))}}}):Zeplin.createDialog({done:{name:"OK",cb:function(){var e=document.querySelector("dialog paper-ripple");e.addEventListener("transitionend",function n(){e.removeEventListener("transitionend",n),t.focus(),t.setSelectionRange(t.value.length,t.value.length)})}}})})}function rn(e,t){wt(t).then(function(t){e.target.value=t.name})}function an(){var e=document.querySelector(".deleteScreenContainer");e&&e.remove()}function sn(e){var t=T(e);t&&t.classList.add("hidden"),fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/screens/"+e,{method:"DELETE",headers:Zeplin.headers}).then(function(e){return e.ok?void 0:e.json().then(function(t){throw Zeplin.createError(e.status,t)})}).then(function(){kt(e).then(function(){H(),Se(),M()})["catch"](function(e){console.warn(e)})})["catch"](function(e){nn(e),t&&t.classList.remove("hidden")})}function cn(e){var t=document.importNode(xa.content,!0),n=t.querySelector(".prevIntegration .slackChannel"),o=new URL(e.incomingWebHook.configurationURL);n.textContent=e.incomingWebHook.channel,n.href=o.origin+"/messages/"+e.incomingWebHook.channel,ba.appendChild(t)}if(Cookies.get("userToken")){var ln=function(){return/iPad|iPhone/.test(navigator.userAgent)?"ios":/Macintosh/.test(navigator.userAgent)?"mac":/Windows/.test(navigator.userAgent)?"win":/Linux/.test(navigator.userAgent)||/X11/.test(navigator.userAgent)?"linux":"unknown"}(),dn=function(){return/Firefox/.test(navigator.userAgent)?"firefox":/OPR/.test(navigator.userAgent)?"opera":/Chrome/.test(navigator.userAgent)?"chrome":/Safari/.test(navigator.userAgent)?"safari":/Edge/.test(navigator.userAgent)?"edge":"unknown"}(),un=function(){switch(dn){case"firefox":return parseInt(navigator.userAgent.match(/Firefox\/(\d*)/)[1],10);case"opera":return parseInt(navigator.userAgent.match(/OPR\/(\d*)/)[1],10);case"chrome":return parseInt(navigator.userAgent.match(/Chrome\/(\d*)/)[1],10);case"safari":return parseInt(navigator.userAgent.match(/Version\/(\d*)/)[1],10);case"edge":return parseInt(navigator.userAgent.match(/Edge\/(\d*)/)[1],10);default:return-1}}(),mn={canDownload:"download"in document.createElement("a"),canCopy:"firefox"===dn&&un>=41||"chrome"===dn&&un>=43||"opera"===dn&&un>=29},pn={pdf:"application/pdf",png:"image/png",svg:"image/svg+xml"},gn={css:"CSS",sass:"Sass",scss:"SCSS",less:"Less",stylus:"Stylus"},fn={fecf33:"yellow",f69833:"orange",ee6723:"peach",c8cf2d:"green","0dcfda":"turquoise"},hn={yellow:{name:"yellow",r:254,g:207,b:51,a:1},orange:{name:"orange",r:246,g:152,b:51,a:1},peach:{name:"peach",r:238,g:103,b:35,a:1},green:{name:"green",r:200,g:207,b:45,a:1},turquoise:{name:"turquoise",r:13,g:207,b:218,a:1}},yn='    Generated by Zeplin\n    Copyright (C) 2014 - present Zeplin\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n       http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n';document.body.classList.add(ln),document.body.classList.toggle("canDownload",mn.canDownload);var vn,En,Ln,xn,bn,Sn,Cn,wn,kn,In,Zn,Tn,Bn,_n=document.getElementById("loading"),On=document.getElementById("userMenu"),Dn=document.getElementById("notificationContainer"),qn=document.querySelector(".projectOverview"),Nn=document.getElementById("screenCount"),Un=document.getElementById("lastEdited"),Rn=document.getElementById("tags"),Pn=document.getElementById("resetTags"),An=document.getElementById("screenGrid"),jn=document.getElementById("projectName"),Mn=document.getElementById("projectType"),Hn=document.getElementById("projectLink"),Fn=document.getElementById("projectLinkMirror"),Kn=document.getElementById("copyProjectLinkButton"),Yn=document.querySelector("title"),zn=document.getElementById("dashboardTab"),Wn=document.getElementById("styleguideTab"),Vn=document.querySelector("header"),Gn=document.querySelector(".headerTitle"),Jn=document.getElementById("upLink"),Xn=document.getElementById("arrowLeft"),$n=document.getElementById("arrowRight"),Qn=document.getElementById("header"),eo=document.getElementById("headerExtra"),to=document.getElementById("inviteUserForm"),no=document.getElementById("addUserButton"),oo=document.getElementById("inviteUserPopup"),ro=document.getElementById("inviteeHandle"),io=document.getElementById("inviteButton"),ao=document.getElementById("noOtherMembers"),so=document.getElementById("members"),co=document.getElementById("generateButton"),lo=document.getElementById("generatePopup"),uo=document.getElementById("colorGenerator"),mo=document.getElementById("iosExportButton"),po=document.getElementById("iosCategoryName"),go=document.getElementById("iosCategoryPrefix"),fo=document.getElementById("osxExportButton"),ho=document.getElementById("osxCategoryName"),yo=document.getElementById("osxCategoryPrefix"),vo=document.getElementById("webColorGenerator"),Eo=document.getElementById("webExportButton"),Lo=document.getElementById("colorPalette"),xo=document.getElementById("slackButton"),bo=document.getElementById("rightSidebar"),So=document.getElementById("screenDescriptionContainer"),Co=document.getElementById("screenDescription"),wo=document.getElementById("screenLastUpdated"),ko=document.getElementById("screenTags"),Io=document.getElementById("layoutGridInfoContainer"),Zo=document.getElementById("layoutGridCheckbox"),To=document.getElementById("gridViz"),Bo=document.getElementById("gridColumnWidth"),_o=document.getElementById("gridGutterWidth"),Oo=document.getElementById("gridColumnViz"),Do=document.getElementById("verticalGutterViz"),qo=document.getElementById("gridRowHeight"),No=document.getElementById("gridGutterHeight"),Uo=document.getElementById("gridTotalWidth"),Ro=document.getElementById("gridNumberOfCols"),Po=document.getElementById("resourceTabs"),Ao=document.getElementById("colorContent"),jo=document.getElementById("screenColors"),Mo=document.getElementById("assetContent"),Ho=document.getElementById("screenAssets"),Fo=document.getElementById("screenAssetExports"),Ko=document.getElementById("layerView"),Yo=document.getElementById("layerName"),zo=document.getElementById("layerPositionX"),Wo=document.getElementById("layerPositionY"),Vo=document.getElementById("layerWidth"),Go=document.getElementById("layerHeight"),Jo=document.getElementById("layerRotation"),Xo=document.getElementById("layerOpacity"),$o=document.getElementById("layerRadius"),Qo=document.getElementById("layerBlendMode"),er=document.getElementById("layerFontFace"),tr=document.getElementById("layerFontSize"),nr=document.getElementById("layerLineHeight"),or=document.getElementById("layerLetterSpacing"),rr=document.getElementById("layerTextColor"),ir=document.getElementById("copyLayerContent"),ar=document.getElementById("layerContent"),sr=document.getElementById("layerFillContainer"),cr=document.getElementById("layerFills"),lr=document.getElementById("layerBorderContainer"),dr=document.getElementById("layerBorders"),ur=document.getElementById("layerShadowContainer"),mr=document.getElementById("layerShadows"),pr=document.getElementById("layerBlurContainer"),gr=document.getElementById("layerBlurType"),fr=document.getElementById("layerBlurRadius"),hr=document.getElementById("layerAssetContainer"),yr=document.getElementById("layerAssetPreview"),vr=document.getElementById("layerAssetName"),Er=document.getElementById("layerAssetExports"),Lr=document.getElementById("styleExportContainer"),xr=document.getElementById("styleOptionsButton"),br=document.getElementById("selectedStyleExportType"),Sr=document.getElementById("styleOptions"),Cr=document.getElementById("showDimensionsCheckbox"),wr=document.getElementById("unitlessLineHeightCheckbox"),kr=document.getElementById("copyStyleContent"),Ir=document.getElementById("layerStyle"),Zr=document.getElementById("styleMirror"),Tr=document.getElementById("zoomIn"),Br=document.getElementById("zoomDropdownLabel"),_r=document.getElementById("zoomDropdown"),Or=document.getElementById("zoomOut"),Dr=document.getElementById("maymusCheckbox"),qr=document.getElementById("screenView"),Nr=document.getElementById("dotgrid"),Ur=document.getElementById("screenContainer"),Rr=document.getElementById("dots"),Pr=document.getElementById("dotPopup"),Ar=document.getElementById("dotColors"),jr=document.getElementById("dotComments"),Mr=document.getElementById("newComment"),Hr=document.getElementById("newCommentButton"),Fr=document.getElementById("newCommentMirror"),Kr=document.getElementById("newCommentNote"),Yr=document.getElementById("newCommentSendButton"),zr=document.getElementById("layers"),Wr=document.getElementById("rulers"),Vr=document.getElementById("topRuler"),Gr=document.getElementById("rightRuler"),Jr=document.getElementById("bottomRuler"),Xr=document.getElementById("leftRuler"),$r=document.getElementById("leftDistance"),Qr=document.getElementById("leftDistanceValue"),ei=document.getElementById("rightDistance"),ti=document.getElementById("rightDistanceValue"),ni=document.getElementById("topDistance"),oi=document.getElementById("topDistanceValue"),ri=document.getElementById("bottomDistance"),ii=document.getElementById("bottomDistanceValue"),ai=document.getElementById("layoutGridContainer"),si=document.getElementById("layoutGridColumns"),ci=document.getElementById("layoutGridRows"),li=document.getElementById("fontBook"),di=document.getElementById("screenImage"),ui=document.getElementById("suggestedUsersBox"),mi=document.getElementById("suggestedUsersContainer"),pi=document.getElementById("searchScreenContainer"),gi=document.getElementById("screenSearchText"),fi=document.getElementById("suggestedScreensContainer"),hi=document.getElementById("jumpToScreen"),yi=document.getElementById("searchPopup"),vi=document.getElementById("namingTip"),Ei=document.getElementById("slackSettingsMenu"),Li=new Set,xi={},bi=!1,Si=-2,Ci=null,wi=null,ki=null,Ii=null,Zi=null,Ti="1x",Bi=1,_i=null,Oi=null,Di=null,qi=/everyone|all|tutti/,Ni=!1,Ui=[],Ri="",Pi="",Ai=null,ji=[],Mi=!0,Hi={},Fi=document.getElementById("memberTemplate");i(),window.addEventListener("hashchange",i);var Ki=(new TextDecoder).decode(new Uint8Array([].map.call(crypto.getRandomValues(new Uint8Array(16)),function(e){return e%94+33}))),Yi=document.getElementById("suggestedUsersTemplate");mi.addEventListener("mousemove",function(e){e.stopPropagation(),Tn===e.clientX&&Bn===e.clientY||(e.target.classList.contains("suggestedUser")&&(ui.querySelector(".selected")&&ui.querySelector(".selected").classList.remove("selected"),e.target.classList.add("selected"),In=Ui[e.target.dataset.index]),Tn=e.clientX,Bn=e.clientY)}),mi.addEventListener("click",function(e){e.stopPropagation(),In=Ui[e.target.dataset.index],ot(e,Kr,Fr)}),[].forEach.call(document.querySelectorAll(".projectTab"),function(e){e.addEventListener("change",function(e){switch(e.target.value){case"styleguide":x();break;case"dashboard":default:"sids"in xi?(L({updateURL:!1}),u(xi.sids)):L()}})}),Jn.addEventListener("click",function(e){"screen"===Ln&&(e.preventDefault(),L())}),no.addEventListener("click",function(e){e.stopPropagation(),oo.classList.remove("hidden"),ro.focus()}),oo.addEventListener("click",function(e){e.stopPropagation()}),ro.parentElement.classList.toggle("typed",!!ro.value),ro.addEventListener("input",function(){ro.parentElement.classList.toggle("typed",!!ro.value)}),to.addEventListener("submit",function(e){e.preventDefault(),to.checkValidity()&&(io.disabled=!0,fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/users",{method:"POST",headers:Zeplin.headers,body:JSON.stringify({handle:ro.value.trim()})}).then(function(e){return e.json().then(function(t){if(e.ok)return t;throw Zeplin.createError(e.status,t)})}).then(function(e){En.users.push({user:e,role:"user"}),n(En.users),oo.classList.add("hidden"),ro.value="",ro.parentElement.classList.remove("typed")})["catch"](function(e){console.error(e),e instanceof ServerError?Zeplin.createDialog({title:e.title,message:e.message}):e instanceof ClientError?Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status&&(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html"))}}}):Zeplin.createDialog()}).then(function(){io.disabled=!1},function(){io.disabled=!1}))});var zi,Wi=document.getElementById("screenTemplate"),Vi=document.getElementById("guidelineColorTemplate");Po.dataset.selection=document.querySelector(".resourceTab:checked").value,[].forEach.call(document.querySelectorAll(".resourceTab"),function(e){e.addEventListener("change",function(e){Po.dataset.selection=e.target.value})});var Gi=document.getElementById("colorTemplate"),Ji=document.getElementById("layerShadowTemplate");Fo.addEventListener("click",te),Ho.addEventListener("click",function(e){if(e.button===Zeplin.MOUSE_BUTTON.LEFT){if(e.target.classList.contains("exportAssets"))return te(e);for(var t=e.target;!t.classList.contains("asset");)t=t.parentElement;var n=t.nextElementSibling;n.style.height=t.classList.contains("expanded")?"0":48*n.children.length+"px",t.classList.toggle("expanded")}}),hr.addEventListener("click",function(e){if(e.button===Zeplin.MOUSE_BUTTON.LEFT){if(e.target.classList.contains("exportAssets"))return te(e);for(var t=e.target;!t.classList.contains("asset");)t=t.parentElement;var n=t.nextElementSibling;n.style.height=t.classList.contains("expanded")?"0":48*n.children.length+"px",t.classList.toggle("expanded")}});var Xi=document.getElementById("assetExportTemplate"),$i=document.getElementById("assetTemplate"),Qi=document.getElementById("layerTemplate");Ar.addEventListener("click",function(e){e.target.classList.contains("dotColor")&&pe(e.target.dataset.color)});var ea,ta=!1;Zeplin.projectPrefs.get(xi.pid,"layoutGridEnabled").then(function(e){Zo.checked=e,ai.classList.toggle("hidden",!e)});var na;Zo.addEventListener("change",function(){ai.classList.toggle("hidden",!Zo.checked),clearTimeout(na),na=setTimeout(function(){Zeplin.projectPrefs.set(xi.pid,"layoutGridEnabled",Zo.checked)},1e3)}),Rn.addEventListener("click",function(e){if(e.button===Zeplin.MOUSE_BUTTON.LEFT&&e.target.classList.contains("tag")){if(e.target.classList.contains("selected"))return e.target.classList.remove("selected"),void Se();("mac"===ln?e.metaKey:e.ctrlKey)||[].forEach.call(document.querySelectorAll(".tag.selected"),function(e){e.classList.remove("selected")}),e.target.classList.add("selected"),Se()}}),Pn.addEventListener("click",function(e){e.button===Zeplin.MOUSE_BUTTON.LEFT&&Ce()}),An.addEventListener("mouseover",function(e){e.target.classList.contains("screenLink")&&e.target.classList.remove("highlight")}),An.addEventListener("keydown",function(e){switch(e.stopPropagation(),e.keyCode){case Zeplin.KEY_CODE.ESC:e.target.blur()}});var oa=!1;An.addEventListener("submit",function(e){e.preventDefault();var t=e.target.parentElement.parentElement.dataset.id,n=e.target.querySelector(".screenName");oa=!0,n.setSelectionRange(0,0),n.blur(),on(t,n)}),An.addEventListener("blur",function(e){if(!oa&&e.target.classList.contains("screenName")){var t=e.target.parentElement.parentElement.parentElement.dataset.id;rn(e,t)}oa=!1},!0),document.addEventListener("keydown",function(e){if(e.keyCode===Zeplin.KEY_CODE.ESC)Oe(),qe(),lo.classList.add("hidden"),oo.classList.add("hidden"),Ye(),Nt(),mt(),an(),Qt(),Lr.classList.remove("styleOptionsOpen"),Ei.classList.add("hidden");else if(e.keyCode===Zeplin.KEY_CODE.ArrowLeft){if(we())return;e.preventDefault(),Si-1>=0&&Le(Si-1)}else if(e.keyCode===Zeplin.KEY_CODE.ArrowRight){if(we())return;e.preventDefault(),Si>=0&&Si+1<An.children.length&&Le(Si+1)}else if(e.altKey)switch(e.keyCode){case Zeplin.KEY_CODE.KeyD:e.stopPropagation(),L();break;case Zeplin.KEY_CODE.KeyG:e.stopPropagation(),x();break;case Zeplin.KEY_CODE.KeyPlus:case Zeplin.KEY_CODE.KeyPlusGecko:case Zeplin.KEY_CODE.KeyPlusChrome:case Zeplin.KEY_CODE.NumpadAdd:e.preventDefault(),e.stopPropagation();for(var t=0;t<_r.childElementCount;t++){var n=parseFloat(_r.children[t].value);if(n>Bi){Bi=n;break}}Nr.classList.add("zooming"),he();break;case Zeplin.KEY_CODE.KeyMinus:case Zeplin.KEY_CODE.KeyMinusGecko:case Zeplin.KEY_CODE.KeyMinusChrome:case Zeplin.KEY_CODE.NumpadSubtract:e.preventDefault(),e.stopPropagation();for(var t=_r.childElementCount-1;t>=0;t--){var n=parseFloat(_r.children[t].value);if(Bi>n){Bi=n;break}}Nr.classList.add("zooming"),he();break;case Zeplin.KEY_CODE.Digit0:case Zeplin.KEY_CODE.Digit0Chrome:case Zeplin.KEY_CODE.Numpad0:e.preventDefault(),e.stopPropagation(),Bi=1,Nr.classList.add("zooming"),he();break;case Zeplin.KEY_CODE.KeyJ:e.preventDefault(),e.stopPropagation(),En.screens&&En.screens.length&&pi.classList.contains("hidden")&&ke()}}),yi.addEventListener("click",function(e){e.stopPropagation(),e.target.classList.contains("screenSuggestion")&&(Zn=ji[e.target.dataset.index],Ie())}),fi.addEventListener("mousemove",function(e){if(e.stopPropagation(),Tn!==e.clientX||Bn!==e.clientY){var t=fi.querySelector(".selected");t&&t.classList.remove("selected"),e.target.classList.add("selected"),Zn=ji[e.target.dataset.index],Tn=e.clientX,Bn=e.clientY}}),yi.addEventListener("keydown",function(e){switch(e.keyCode){case Zeplin.KEY_CODE.ArrowDown:e.preventDefault(),Ze();break;case Zeplin.KEY_CODE.ArrowUp:e.preventDefault(),Te();break;case Zeplin.KEY_CODE.ENTER:e.preventDefault(),Ie();break;case Zeplin.KEY_CODE.ESC:e.preventDefault(),Nt()}}),gi.addEventListener("input",function(e){e.preventDefault(),Dt(e.target.value)}),hi.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),En.screens&&En.screens.length&&pi.classList.contains("hidden")&&ke()}),Xn.addEventListener("click",function(e){e.button===Zeplin.MOUSE_BUTTON.LEFT&&Si-1>=0&&(Be(),Le(Si-1))}),$n.addEventListener("click",function(e){e.button===Zeplin.MOUSE_BUTTON.LEFT&&Si+1<En.screens.length&&(Be(),Le(Si+1))}),document.addEventListener("click",function(e){e.button!==Zeplin.MOUSE_BUTTON.LEFT||document.querySelector("dialog")||(Oe(),qe(),lo.classList.add("hidden"),oo.classList.add("hidden"),Ye(),Nt(),mt(),an(),Qt(),Lr.classList.remove("styleOptionsOpen"),Ei.classList.add("hidden"))}),document.getElementById("closeLayerView").addEventListener("click",function(){Oe(),qe()});var ra=document.getElementById("layerBorderTemplate");xr.addEventListener("click",function(e){e.button===Zeplin.MOUSE_BUTTON.LEFT&&(e.stopPropagation(),Lr.classList.toggle("styleOptionsOpen"))}),Sr.addEventListener("click",function(e){e.button!==Zeplin.MOUSE_BUTTON.LEFT&&e.stopPropagation()}),[].forEach.call(document.querySelectorAll("input[name='styleExportType']"),function(e){e.addEventListener("change",function(e){vo.dataset.exportType=e.target.value,br.textContent=gn[e.target.value],document.querySelector("input[name='webColorType'][value='"+e.target.value+"']").checked=!0,Zeplin.projectPrefs.set(xi.pid,"webStyleExportType",e.target.value).then(Fe)})});var ia;Cr.addEventListener("change",function(){clearTimeout(ia),ia=setTimeout(function(){Zeplin.projectPrefs.set(xi.pid,"webShowDimensions",Cr.checked).then(function(){Fe()})})});var aa;wr.addEventListener("change",function(){clearTimeout(aa),aa=setTimeout(function(){Zeplin.projectPrefs.set(xi.pid,"webUnitlessLineHeight",wr.checked).then(function(){Fe()})})}),document.elementsFromPoint&&document.body.classList.add("esfp"),Ur.addEventListener("click",function(e){var t=!1;if(e.target.classList.contains("dot"))e.stopPropagation(),t=!0,Pe(e.target);else if(ca||("mac"===ln?e.metaKey:e.ctrlKey)){e.stopPropagation(),t=!0,Ye(),Dr.checked=!0,Rr.classList.remove("hidden"),Zeplin.projectPrefs.set(xi.pid,"noteVisibility",!0),jr.innerHTML="",jr.scrollTop=0,Pr.classList.add("hidden"),Oi&&!wi&&Oi.remove(),Oi=null;var n=Rr.getBoundingClientRect(),o=Ci.dots&&Ci.dots.length?""+(parseInt(Ci.dots[Ci.dots.length-1].name,10)+1):"1";wi=null,Zeplin.projectPrefs.get(xi.pid,"lastNoteColorUsed").then(function(t){Di={name:o,x:Math.max(0,Math.min((e.clientX-n.left)/n.width,1)),y:Math.max(0,Math.min((e.clientY-n.top)/n.height,1)),color:hn[t]},Pe(ue(Di))})}else if(e.target.classList.contains("layer")){e.stopPropagation(),t=!0,Oe();var r=e.target;if(document.elementsFromPoint)for(var i=document.elementsFromPoint(e.clientX,e.clientY).filter(function(e){return e.classList.contains("layer")}),a=0;a<i.length;a++)if(i[a].classList.contains("selected")){r=i[a===i.length-1?0:a+1];break}je(r)}t&&(On.classList.add("hidden"),Dn.classList.add("hidden"),Lr.classList.remove("styleOptionsOpen"))}),Ur.addEventListener("mouseleave",function(){Ii&&(Nr.addEventListener("mousemove",Re),Ur.classList.add("measuring"))}),Ur.addEventListener("mouseenter",function(){Nr.removeEventListener("mousemove",Re)}),Nr.addEventListener("mouseenter",function(){Ur.classList.add("measuring")}),Nr.addEventListener("mouseleave",function(){Ur.classList.remove("measuring"),Ne()}),Tr.addEventListener("click",function(e){e.stopPropagation();for(var t=0;t<_r.childElementCount;t++){var n=parseFloat(_r.children[t].value);if(n>Bi){Bi=n;break}}Nr.classList.add("zooming"),he()}),Or.addEventListener("click",function(e){e.stopPropagation();for(var t=_r.childElementCount-1;t>=0;t--){var n=parseFloat(_r.children[t].value);if(Bi>n){Bi=n;break}}Nr.classList.add("zooming"),he()}),_r.addEventListener("click",function(e){e.stopPropagation()}),Zeplin.projectPrefs.get(xi.pid,"zoomLevel").then(function(e){Bi=e,Br.textContent=(100*Bi).toFixed(),Tr.disabled=5===Bi,Or.disabled=.25===Bi,he({saveZoomLevel:!1})}),_r.addEventListener("change",function(){Bi=parseFloat(_r.value),Nr.classList.add("zooming"),he({updateSelectedIndex:!1})}),Nr.addEventListener("wheel",function(e){e.ctrlKey&&(e.preventDefault(),Bi=Math.max(.25,Math.min(Bi-e.deltaY/100,5)),he())}),Zeplin.projectPrefs.get(xi.pid,"noteVisibility").then(function(e){Dr.checked=e,Rr.classList.toggle("hidden",!e)});var sa;Dr.addEventListener("change",function(){Rr.classList.toggle("hidden",!Dr.checked),clearTimeout(sa),sa=setTimeout(function(){Zeplin.projectPrefs.set(xi.pid,"noteVisibility",Dr.checked)},1e3)});var ca=!1;document.getElementById("addNoteButton").addEventListener("click",function(e){e.stopPropagation(),Ke()});var la,da,ua=!1,ma=new Autolinker({stripPrefix:!1,className:"link",phone:!1,twitter:!1,hashtag:!1,replaceFn:function(e,t){switch(t.getType()){case"url":var n=t.getUrl();if(0===n.indexOf(location.origin+location.pathname)){var o={},r=n.substr(n.indexOf("#")).replace("&amp;","&");if(r.substr(1).split("&").forEach(function(e){var t=e.split("=");o[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}),"pid"in o&&o.pid===En._id){var i,a=["link"];if("sid"in o){for(var s="unknown",c=0;c<En.screens.length;c++)if(En.screens[c]._id===o.sid){s=En.screens[c].name;break}a.push("screenLink"),i=s}else i=En.name;if(i)return da.push('<a href="'+r+'" class="'+a.join(" ")+'">'+i+"</a>"),"{{link:"+(da.length-1)+"}}"}}var l=e.getTagBuilder().build(t);return l.setAttr("rel","nofollow external"),da.push(l.toAnchorString()),"{{link:"+(da.length-1)+"}}";case"email":return da.push(e.getTagBuilder().build(t).toAnchorString()),"{{link:"+(da.length-1)+"}}";default:return!1}}}),pa=document.getElementById("commentTemplate");Pr.addEventListener("click",function(e){e.stopPropagation();var t;if(e.target.classList.contains("commentEditButton")){t=e.target.parentElement.parentElement.parentElement.parentElement;var n=Pr.querySelector(".comment.editing");n&&(n.querySelector(".commentMirror").innerHTML=Ge(Ve(ki.note)),n.classList.remove("editing")),Mr.classList.add("hidden"),Mr.classList.remove("composing"),Fr.innerHTML="&nbsp;",Kr.value="";for(var o=t.querySelector(".commentMirror"),r=t.querySelector(".commentNote"),i=0;i<wi.comments.length;i++){var a=wi.comments[i];if(a._id===t.dataset.id){ki=a;break}}o.innerHTML=Ve(ki.note),r.value=ki.note,t.classList.add("editing"),r.focus()}else if(e.target.classList.contains("commentDeleteButton")){t=e.target.parentElement.parentElement.parentElement.parentElement;var s="Delete comment?";t.classList.contains("commentOwner")||(s="Delete "+t.querySelector(".commentAuthorName").textContent+"'s comment?"),Zeplin.createDialog({title:s,message:"Deleted comments cannot be restored.",done:{name:"DELETE",cb:function(){tt(e.target.parentElement.parentElement.parentElement.parentElement)}},cancel:{name:"CANCEL",cb:function(){Oe()}}})}else e.target.classList.contains("commentDoneButton")&&et(e.target.parentElement.parentElement.parentElement)}),Pr.addEventListener("keydown",function(e){if(e.target.classList.contains("commentNote")){e.stopPropagation();for(var t=e.target.parentElement;!t.classList.contains("comment");)t=t.parentElement;switch(e.keyCode){case Zeplin.KEY_CODE.ENTER:("mac"===ln?e.metaKey:e.ctrlKey)&&et(t);break;case Zeplin.KEY_CODE.ESC:mi.classList.contains("hidden")||(mi.classList.add("hidden"),lt(),Pr.appendChild(mi)),t.classList.remove("editing"),Mr.classList.remove("hidden"),t.querySelector(".commentMirror").innerHTML=Ge(Ve(ki.note)),e.target.blur()}}}),Hr.addEventListener("click",function(){Mr.classList.add("composing"),Kr.focus()}),Kr.addEventListener("input",function(e){nt(e,Fr,Kr,Pr)}),Kr.addEventListener("click",function(e){e.stopPropagation(),nt(e,Fr,Kr,Pr)}),Yr.addEventListener("click",function(){wi?Qe():me()}),Kr.addEventListener("keyup",function(e){switch(e.stopPropagation(),e.keyCode){case Zeplin.KEY_CODE.ArrowLeft:case Zeplin.KEY_CODE.ArrowRight:
ct(Kr)}}),Kr.addEventListener("keydown",function(e){switch(e.stopPropagation(),e.keyCode){case Zeplin.KEY_CODE.ENTER:mi.classList.contains("hidden")?("mac"===ln?e.metaKey:e.ctrlKey)&&(wi?Qe():me()):ot(e,Kr,Fr);break;case Zeplin.KEY_CODE.ESC:mi.classList.contains("hidden")?(Mr.classList.remove("composing"),Fr.innerHTML="&nbsp;",Kr.value="",wi||Oe()):(mi.classList.add("hidden"),lt());break;case Zeplin.KEY_CODE.ArrowDown:rt(e);break;case Zeplin.KEY_CODE.ArrowUp:it(e)}}),jr.addEventListener("mouseover",function(e){if(e.target!==jr){for(var t=e.target;!t.classList.contains("comment");)t=t.parentElement;t.classList.remove("highlight")}}),fetch(Zeplin.urls.baseURL+"/urls",{method:"POST",headers:Zeplin.headers,body:JSON.stringify({url:location.origin+"/project.html#pid="+xi.pid})}).then(function(e){return e.json().then(function(t){if(e.ok)return t;throw Zeplin.createError(e.status,t)})}).then(function(e){var t=e.url;Hn.href=t,Hn.textContent=Hn.host+Hn.pathname,Fn.textContent=t})["catch"](function(e){console.error(e),e instanceof ClientError&&Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status?(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html")):(Hn.href=location.origin+"/project.html#pid="+xi.pid,Hn.textContent=location.host+"/project.html#pid="+xi.pid,Fn.textContent=Hn.href)}}})}),mn.canCopy?(Kn.addEventListener("click",function(){var e=getSelection(),t=document.createRange();e.removeAllRanges(),t.selectNodeContents(Fn.firstChild),e.addRange(t);try{document.execCommand("copy")&&dt("Copied to clipboard!","right")}catch(n){console.error("Unable to copy project shortlink")}e.removeAllRanges()}),ir.addEventListener("click",function(){var e=getSelection(),t=!1;if(!e||!e.anchorNode||e.anchorNode.parentNode!==ar){var n=document.createRange();e.removeAllRanges(),n.selectNodeContents(ar.firstChild),e.addRange(n),t=!0}try{document.execCommand("copy")&&dt("Copied to clipboard!","right")}catch(o){console.error("Unable to copy layer content")}t&&e.removeAllRanges()}),kr.addEventListener("click",function(){Zr.select();try{document.execCommand("copy")&&dt("Copied to clipboard!","right")}catch(e){console.error("Unable to copy layer content")}getSelection().removeAllRanges()})):(Kn.remove(),ir.remove(),kr.remove()),ar.addEventListener("focus",function(){var e=getSelection(),t=document.createRange();if(e.removeAllRanges(),t.selectNodeContents(ar.firstChild),e.addRange(t),mn.canCopy)try{document.execCommand("copy")&&dt("Copied to clipboard!","right")}catch(n){console.error("Unable to copy layer content")}e.removeAllRanges(),t=document.createRange(),t.selectNodeContents(ar.firstChild),setTimeout(function(){e.addRange(t)},20)}),bo.addEventListener("click",function(e){e.stopPropagation(),e.target.classList.contains("addColor")&&Mi&&(Mi=!1,At(e)),On.classList.add("hidden"),Dn.classList.add("hidden"),Lr.classList.remove("styleOptionsOpen")}),bo.addEventListener("contextmenu",function(e){e.stopPropagation()}),bo.addEventListener("copy",ut),Lo.addEventListener("copy",ut),Lo.addEventListener("contextmenu",function(e){if(mt(),e.target.classList.contains("color")){var t=e.target,n=document.getElementById("deleteColorTemplate"),o=document.importNode(n.content,!0),r=o.querySelector(".deleteColorContainer");e.preventDefault(),r.querySelector("button").dataset.name=t.querySelector(".colorName").value,r.style.left=e.offsetX+2+"px",r.style.top=e.offsetY+2+"px",r.querySelector("button").addEventListener("click",function(e){if(e.button===Zeplin.MOUSE_BUTTON.LEFT){var n=e.target.querySelector("paper-ripple");n.addEventListener("transitionend",function o(){n.removeEventListener("transitionend",o),jt(t),mt()})}}),t.appendChild(o)}}),Lo.addEventListener("mouseover",function(e){if(e.target!==Lo){for(var t=e.target;!t.classList.contains("color");)t=t.parentElement;t.classList.remove("highlight")}}),Lo.addEventListener("input",function(e){var t={ios:/([^a-zA-Z0-9])/g,osx:/([^a-zA-Z0-9])/g,web:/([^a-zA-Z0-9-_])/g,android:/([^a-z0-9_])/g},n=e.target.selectionStart,o=e.target.selectionEnd;e.preventDefault(),e.target.classList.contains("colorName")?(e.target.value=e.target.value.replace(t[En.type],""),e.target.setSelectionRange(n,o)):e.target.classList.contains("colorHex")?(e.target.value=e.target.value.replace(/([^a-fA-F0-9])/g,""),e.target.value=e.target.value.replace(/([^a-fA-F0-9])/g,""),e.target.setSelectionRange(n,o)):e.target.classList.contains("colorAlpha")&&(e.target.value=e.target.value.replace(/([^0-9])/g,""),e.target.setSelectionRange(n,o))}),Lo.addEventListener("blur",function(e){var t;e.stopPropagation(),e.target.classList.contains("colorName")?(t=new Zeplin.Color(JSON.parse(e.target.parentElement.parentElement.parentElement.dataset.rgbcolor)),e.target.value=t.name):e.target.classList.contains("colorHex")?(t=new Zeplin.Color(JSON.parse(e.target.parentElement.parentElement.parentElement.parentElement.dataset.rgbcolor)),e.target.value=t.toHexString().split(" ")[0].slice(1)):e.target.classList.contains("colorAlpha")&&(t=new Zeplin.Color(JSON.parse(e.target.parentElement.parentElement.parentElement.parentElement.dataset.rgbcolor)),e.target.value=Math.round(100*t.a))},!0),Lo.addEventListener("keydown",function(e){e.stopPropagation();var t,n,o={},r={ios:/[^a-zA-Z0-9]/,osx:/[^a-zA-Z0-9]/,web:/[^a-zA-Z0-9-_]/,android:/[^a-z0-9_]/};switch(e.keyCode){case Zeplin.KEY_CODE.ESC:e.target.blur();break;case Zeplin.KEY_CODE.ENTER:if(e.preventDefault(),e.target.classList.contains("colorName")){if(n=e.target.parentElement.parentElement.parentElement,t=new Zeplin.Color(JSON.parse(n.dataset.rgbcolor)),!e.target.value||r[En.type].test(e.target.value))return void(e.target.value=t.name);Gt(e.target.value,n.dataset.id)?(Zeplin.createDialog({title:e.target.value+" already exists",message:"Please enter another name for this color.",done:{name:"GOT IT"}}),e.target.value=t.name):(o={name:e.target.value},Jt(n.dataset.id,o,t,n,e))}else if(e.target.classList.contains("colorHex")){if(!e.target.value||e.target.value.length<5)return;if(n=e.target.parentElement.parentElement.parentElement.parentElement,t=new Zeplin.Color(JSON.parse(n.dataset.rgbcolor)),!e.target.value||/[^A-Fa-f0-9]/.test(e.target.value))return void(e.target.value=t.toHexString().split(" ")[0].slice(1));var i=pt(e.target.value,n.dataset.id,t);i?(Zeplin.createDialog({title:"This color already exists: "+i,message:"Please check the values and try again!",done:{name:"GOT IT"}}),e.target.value=t.toHexString().split(/\s/)[0].substr(1)):(o=Xt(e.target.value),Jt(n.dataset.id,o,t,n,e))}else if(e.target.classList.contains("colorAlpha")){if(n=e.target.parentElement.parentElement.parentElement.parentElement,t=new Zeplin.Color(JSON.parse(n.dataset.rgbcolor)),!e.target.value||/[^0-9]/.test(e.target.value)||e.target.value/100>1)return void(e.target.value=Math.round(100*t.a));var i=gt(e.target.value,n.dataset.id,t);i?(Zeplin.createDialog({title:"This color already exists: "+i,message:"Please check the values and try again!",done:{name:"GOT IT"}}),e.target.value=Math.round(100*t.a)):(o={a:e.target.value/100},Jt(n.dataset.id,o,t,n,e))}}}),uo.addEventListener("click",function(e){e.stopPropagation()}),[].forEach.call(document.querySelectorAll("input[name='webColorType']"),function(e){e.addEventListener("change",function(e){vo.dataset.exportType=e.target.value,br.textContent=gn[e.target.value],document.querySelector("input[name='styleExportType'][value='"+e.target.value+"']").checked=!0,Zeplin.projectPrefs.set(xi.pid,"webStyleExportType",e.target.value)})}),mn.canDownload&&(mo.addEventListener("click",yt),fo.addEventListener("click",vt),Eo.addEventListener("click",Et),co.addEventListener("click",function(e){switch(mixpanel.track("Clicked generate color button"),En.type){case"android":Lt();break;case"ios":e.preventDefault(),lo.classList.toggle("hidden"),po.select();break;case"osx":e.preventDefault(),lo.classList.toggle("hidden"),ho.select();break;case"web":e.preventDefault(),lo.classList.toggle("hidden")}}),go.addEventListener("blur",function(){go.value!==En.prefix&&fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/prefix",{method:"PUT",headers:Zeplin.headers,body:JSON.stringify({prefix:go.value})}).then(function(e){return e.json().then(function(t){if(e.ok)return t;throw Zeplin.createError(e.status,t)})}).then(function(e){En.prefix=e.prefix})["catch"](function(e){console.error(e),e instanceof ClientError&&Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status&&(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html"))}}})})}),yo.addEventListener("blur",function(){yo.value!==En.prefix&&fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/prefix",{method:"PUT",headers:Zeplin.headers,body:JSON.stringify({prefix:yo.value})}).then(function(e){return e.json().then(function(t){if(e.ok)return t;throw Zeplin.createError(e.status,t)})}).then(function(e){En.prefix=e.prefix})["catch"](function(e){console.error(e),e instanceof ClientError&&Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status&&(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html"))}}})})}));var ga=window.devicePixelRatio;setInterval(function(){window.devicePixelRatio!==ga&&(ga=window.devicePixelRatio,Ee(Ci,"zoom"))},1e3);var fa=Zeplin.pusher.subscribe("private-project@"+xi.pid);fa.bind("UpdateProjectDensity",function(e){h(e.body.density),Si>=0&&(Ee(Ci,"density"),ye(Ci.grid)),Fe()}),fa.bind("UpdateProjectName",function(e){Ot(e.body.name),y(e.body.prefix)}),fa.bind("UpdateProjectPrefix",function(e){y(e.body.prefix)}),fa.bind("ArchiveProject",function(e){xt(e.params.uid).then(function(e){Zeplin.createDialog({title:e.user.username+" archived this project.",message:"You won't be able to access these resources from now on.\nIf you think this is a mistake, please contact "+e.user.username,done:{name:"OK",cb:function(){location.replace("projects.html")}}})})["catch"](function(e){console.warn(e)})}),fa.bind("DeleteProject",function(e){xt(e.params.uid).then(function(e){Zeplin.createDialog({title:e.user.username+" deleted this project.",message:"You won't be able to access these resources from now on.\nIf you think this is a mistake, please contact "+e.user.username,done:{name:"OK",cb:function(){location.replace("projects.html")}}})})["catch"](function(e){console.warn(e)})}),fa.bind("InviteUser",function(e){En.users.push({user:e.body,role:"user"}),n(En.users)}),fa.bind("CreateUser",function(e){xt(e.params.uid).then(function(t){t.user.username=e.body.username,t.user.status="registered"}).then(n)["catch"](function(e){console.warn(e)})}),fa.bind("UpdateUsername",function(e){xt(e.params.uid).then(function(t){t.user.username=e.body.username}).then(n)["catch"](function(e){console.warn(e)})}),fa.bind("UpdateEmail",function(e){xt(e.params.uid).then(function(t){t.user.email=e.body.email})["catch"](function(e){console.warn(e)})}),fa.bind("CreateColor",function(e){Ht(e.body)}),fa.bind("UpdateColor",function(e){Kt(e.params.cid,e.body)}),fa.bind("DeleteColor",function(e){Ft(e.params.cid)}),fa.bind("UpdateScreen",function(e){wt(e.params.sid).then(function(t){if("name"in e.body){var n=T(t._id);n&&(n.querySelector(".screenName").value=e.body.name),t.name=e.body.name,Ci&&Ci._id===e.params.sid&&(E(),Qn.textContent=e.body.name,Qn.title=e.body.name)}"description"in e.body&&(t.description=e.body.description,Ci&&Ci._id===e.params.sid&&(Co.textContent=e.body.description))})["catch"](function(e){console.warn(e)})}),fa.bind("UpdateScreenOrder",function(e){kt(e.params.sid).then(function(t){En.screens.splice(e.body.index,0,t),Se()})["catch"](function(e){console.warn(e)})}),fa.bind("UpdateScreensOrder",function(e){e.body.screens=e.body.screens.sort(function(e,t){return e.to-t.to}),Promise.all(e.body.screens.map(function(e){return kt(e._id)})).then(function(t){En.screens.splice.apply(En.screens,[e.body.screens[0].to,0].concat(t)),Se()})["catch"](function(e){console.warn(e)})}),fa.bind("UpdateScreensTags",function(e){Promise.all(e.body.screens.map(function(e){return wt(e._id).then(function(t){switch(e.operation){case"add":t.tags=t.tags?t.tags.concat(e.tags):e.tags;break;case"remove":e.tags.forEach(function(e){t.tags.splice(t.tags.indexOf(e),1)})}Ci&&Ci._id===e._id&&fe(Ci)})})).then(H).then(Se)}),fa.bind("DeleteScreen",function(e){kt(e.params.sid).then(function(t){return H(),Se(),M(),Ci&&Ci._id===e.params.sid?xt(e.params.uid).then(function(e){Zeplin.createDialog({title:e.user.username+" deleted this screen",message:"You won't be able to access \""+t.name+'" from now on.'}),L()}):void 0})["catch"](function(e){console.warn(e)})}),fa.bind("DeleteScreens",function(e){Promise.all(e.body.screens.map(function(e){return kt(e._id)})).then(function(t){return Ci&&t.some(function(e){return Ci._id===e._id})?xt(e.params.uid).then(function(e){Zeplin.createDialog({title:e.user.username+" deleted this screen",message:"You won't be able to access \""+s.name+'" from now on.'}),L()}):void 0}).then(H).then(Se).then(M)["catch"](function(e){console.warn(e)})}),fa.bind("UpdateDot",function(e){wt(e.params.sid).then(function(t){if(!t.dots)throw"Screen dots are not fetched yet.";return It(t,e.params.did)}).then(function(t){var n=document.querySelector(".dot[data-id='"+t._id+"']");if("color"in e.body){var o=fn[new Zeplin.Color(e.body.color).hexBase()];wi&&wi._id===t._id&&(de(Pr),Pr.classList.add(o)),n&&(de(n),n.classList.add(o),n.dataset.color=o),t.color=e.body.color}"x"in e.body&&"y"in e.body&&(n&&(n.dataset.position=e.body.x<=.5?"left":"right",n.style.left="calc("+100*e.body.x+"% - 10px)",n.style.top="calc("+100*e.body.y+"% - 10px)"),t.x=e.body.x,t.y=e.body.y)})["catch"](function(e){console.warn(e)})}),fa.bind("DeleteDot",function(e){wt(e.params.sid).then(function(t){return t.dots?Zt(t,e.params.did).then(function(){var t=T(e.params.sid);if(t){var n=document.querySelector(".dot[data-id='"+e.params.did+"']");n&&(Oi===n&&Oe(),n.remove())}}):void 0})["catch"](function(e){console.warn(e)})}),fa.bind("DeleteDotComment",function(e){wt(e.params.sid).then(function(t){return t.dots?It(t,e.params.did).then(function(n){var o=document.querySelector(".dot[data-id='"+e.params.did+"']"),r=wi&&wi._id===e.params.did;return Bt(n,e.params.cmid).then(function(){return n.comments.length?document.querySelector(".comment[data-id='"+e.params.cmid+"']"):(r&&Oe(),Zt(t,e.params.did).then(function(){return o}))}).then(function(e){e&&e.remove()})}):void 0})["catch"](function(e){console.warn(e)})}),fa.bind("AuthSlack",function(e){En.integration&&En.integration.slack?En.integration.slack.push(e.body.integration.slack[0]):En.integration=e.body.integration;var t=new URL(En.integration.slack[En.integration.slack.length-1].incomingWebHook.configurationURL),n=En.integration.slack[En.integration.slack.length-1].incomingWebHook.channel;document.getElementById("slackChannel").textContent=n,document.getElementById("slackChannel").title=n,document.getElementById("slackChannel").href=t.origin+"/messages/"+n,Ei.querySelector(".slackSettings").href=En.integration.slack[En.integration.slack.length-1].incomingWebHook.configurationURL,document.getElementById("slackIntegration").classList.add("enabled"),document.getElementById("slackIntegrationRow").classList.add("hidden"),En.integration.slack.length>1&&En.integration.slack.slice(0,En.integration.slack.length-1).reverse().forEach(cn)}),window.addEventListener("offline",function(){Vn.classList.contains("tabs")||(eo.textContent="Looks like there is a problem with the connection.",Vn.className="offline")}),window.addEventListener("online",function(){Cookies.get("userToken")&&(Vn.classList.contains("tabs")||(eo.textContent="Keep working! Connection is back…",Vn.className="online"),Ni=!0,setTimeout(function(){S(xi.pid)},1e3))}),Zeplin.getUserInfo().then(function(e){qi=new RegExp("(?:"+[e.username,"everyone","all","tutti"].join("|")+")\\b")}),fa.bind("UpdateUserRole",function(e){Zeplin.getUserInfo().then(function(t){xt(e.params.mid).then(function(n){n.role=e.body.role,e.params.mid===t._id&&(document.body.dataset.userRole=e.body.role)}).then(n)["catch"](function(e){console.warn(e)})})}),fa.bind("TransferOwnership",function(e){Zeplin.getUserInfo().then(function(t){xt(e.params.uid).then(function(n){return n.role="admin",e.params.uid===t._id&&(document.body.dataset.userRole="admin"),xt(e.params.mid)}).then(function(e){e.role="owner"}).then(n)["catch"](function(e){console.warn(e)})})}),fa.bind("RemoveUserFromProject",function(e){Zeplin.getUserInfo().then(function(t){bt(e.params.mid).then(function(){return e.params.mid===t._id?(Oe(),xt(e.params.uid).then(function(e){Zeplin.createDialog({title:e.user.username+' removed you from "'+En.name+'"',message:"You won't be able to access these resources from now on.\nIf you think this is a mistake, please contact "+e.user.username,done:{name:"OK",cb:function(){location.replace("projects.html")}}})})):void n(En.users)}).then(De)["catch"](function(e){console.warn(e)})})}),fa.bind("CreateScreen",function(e){e.body.dots=e.body.dots||[],e.body.tags=e.body.tags||[],En.screens.push(e.body),N(En.screens.length-1),Se(),"dasboard"!==Ln||window.CSS&&CSS.supports("grid-template-columns","repeat(auto-fill, 220px)")||P()}),fa.bind("CreateSnapshot",function(e){Zeplin.getUserInfo().then(function(t){wt(e.params.sid).then(function(n){e.params.uid===t._id;n.currentSnapshot=e.body,n.updated=(new Date).toISOString();var o=T(e.params.sid);o&&(o.querySelector(".screenImage").src=e.body.url,o.querySelector(".screenLastUpdated").setAttribute("datetime",n.updated),Ci&&Ci._id===e.params.sid&&(bo.classList.add("resourceView"),bo.classList.remove("layerView"),wo.setAttribute("datetime",n.updated)));for(var r=0;r<En.screens.length;r++)if(En.screens[r]._id===e.params.sid){N(r,"replace");break}})["catch"](function(e){console.warn(e)})})}),fa.bind("CreateDot",function(e){Zeplin.getUserInfo().then(function(t){var n=e.params.uid===t._id,o=Ci&&Ci._id===e.params.sid,r=qi.test(e.body.comments[0].note);T(e.params.sid);wt(e.params.sid).then(function(t){t.dots&&(t.dots.push(e.body),o&&ue(e.body))})["catch"](function(e){console.warn(e)}),!n&&r&&xt(e.params.uid).then(function(t){_t({title:t.user.username+" mentioned you",body:e.body.comments[0].note,notifier:t.user,handler:function(){location.assign("project.html#pid="+e.params.pid+"&sid="+e.params.sid+"&did="+e.body._id+"&cmid="+e.body.comments[0]._id)}})})})}),fa.bind("CreateDotComment",function(e){Zeplin.getUserInfo().then(function(t){var n=e.params.uid===t._id,o=Ci&&Ci._id===e.params.sid,r=wi&&wi._id===e.params.did,i=qi.test(e.body.note),a=T(e.params.sid);wt(e.params.sid).then(function(t){return t.dots?It(t,e.params.did).then(function(t){var i;t.comments.push(e.body),r&&(i=Xe(e.body)),!n&&a&&o&&r&&(d(i),ze())}):void 0})["catch"](function(e){console.warn(e)}),!n&&i&&xt(e.params.uid).then(function(t){_t({title:t.user.username+" mentioned you",body:e.body.note,notifier:t.user,handler:function(){location.assign("project.html#pid="+e.params.pid+"&sid="+e.params.sid+"&did="+e.params.did+"&cmid="+e.body._id)}})})})}),fa.bind("UpdateDotCommentNote",function(e){Zeplin.getUserInfo().then(function(t){var n=e.params.uid===t._id,o=Ci&&Ci._id===e.params.sid,r=wi&&wi._id===e.params.did,i=qi.test(e.body.note),a=T(e.params.sid);wt(e.params.sid).then(function(t){return t.dots?It(t,e.params.did).then(function(t){return Tt(t,e.params.cmid).then(function(t){var i=new Date(t.created),s=e.body.updated?new Date(e.body.updated):new Date;if(t.note=e.body.note,t.updated=s,!n&&a&&o&&r){var c=document.querySelector(".comment[data-id='"+e.params.cmid+"']");c.querySelector(".commentMirror").innerHTML=Ge(Ve(e.body.note)),c.querySelector(".commentEdited").setAttribute("datetime",s-i>3e5?s:""),d(c),ze()}})}):void 0})["catch"](function(e){console.warn(e)}),!n&&i&&xt(e.params.uid).then(function(t){_t({title:t.user.username+" mentioned you",body:e.body.note,notifier:t.user,handler:function(){location.assign("project.html#pid="+e.params.pid+"&sid="+e.params.sid+"&did="+e.params.did+"&cmid="+e.params.cmid)}})})})});var ha=document.getElementById("screenSuggestionTemplate"),ya=document.getElementById("memberMenu");so.addEventListener("click",function(e){if(e.preventDefault(),e.target.classList.contains("wheel")&&!e.target.parentElement.classList.contains("memberMenuOpen")){e.stopPropagation();var t=e.target.parentElement;t.classList.add("memberMenuOpen"),t.appendChild(ya),ya.classList.remove("hidden")}else Qt()}),ya.addEventListener("click",function(e){e.stopPropagation();var t=ya.parentElement,n=t.dataset.id,o=e.target,r=o.querySelector("paper-ripple");r.addEventListener("transitionend",function i(){if(r.removeEventListener("transitionend",i),o.classList.contains("assign"))$t(n,"admin",ya.parentElement);else if(o.classList.contains("unassign"))$t(n,"user",ya.parentElement);else if(o.classList.contains("transfer"))Zeplin.createDialog({message:'Transfer ownership of "'+En.name+'" to '+t.querySelector(".memberName").textContent+"?",done:{name:"TRANSFER",cb:function(){tn(n)}},cancel:{name:"CANCEL"}});else if(o.classList.contains("remove")){var e,a;t.dataset.id===Zeplin.user._id?(e='Leave "'+En.name+'"?',a="LEAVE"):(e='Remove "'+t.querySelector(".memberName").textContent+'" ?',a="REMOVE"),Zeplin.createDialog({message:e,done:{name:a,cb:function(){en(n)}},cancel:{name:"CANCEL"}})}Qt()})}),jn.addEventListener("keydown",function(e){switch(e.stopPropagation(),e.keyCode){case Zeplin.KEY_CODE.ESC:jn.blur()}}),jn.addEventListener("blur",function(){return Ea?void(Ea=!1):void(jn.value=En.name)});var va=document.getElementById("projectNameForm"),Ea=!1;va.addEventListener("submit",function(e){e.preventDefault(),Ea=!0,jn.blur(),fetch(Zeplin.urls.baseURL+"/projects/"+En._id+"/name",{method:"PUT",headers:Zeplin.headers,body:JSON.stringify({name:jn.value})}).then(function(e){return e.json().then(function(t){if(e.ok)return t;throw Zeplin.createError(e.status,t)})}).then(function(e){Ot(e.name),y(e.prefix)})["catch"](function(e){console.error(e),e instanceof ServerError?Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){var e=document.querySelector("dialog paper-ripple");e.addEventListener("transitionend",function t(){e.removeEventListener("transitionend",t),jn.focus(),jn.setSelectionRange(jn.value.length,jn.value.length)})}}}):e instanceof ClientError?Zeplin.createDialog({title:e.title,message:e.message,done:{name:"OK",cb:function(){401===e.status&&(Cookies.expire("userToken"),localStorage.removeItem("user"),sessionStorage.setItem("redirectTo",location.href),location.replace("login.html"))}}}):Zeplin.createDialog({done:{name:"OK",cb:function(){var e=document.querySelector("dialog paper-ripple");e.addEventListener("transitionend",function t(){e.removeEventListener("transitionend",t),jn.focus(),jn.setSelectionRange(jn.value.length,jn.value.length)})}}})})}),An.addEventListener("contextmenu",function(e){if(an(),e.target.classList.contains("screenLink")){var t=document.getElementById("deleteScreenTemplate"),n=document.importNode(t.content,!0),o=n.querySelector(".deleteScreenContainer"),r=e.target.parentElement;e.preventDefault(),o.style.left=e.offsetX+2+"px",o.style.top=e.offsetY+2+"px",o.dataset.id=e.target.parentElement.dataset.id,o.querySelector("button").addEventListener("click",function(e){if(e.button===Zeplin.MOUSE_BUTTON.LEFT){e.stopPropagation();var t=e.target.querySelector("paper-ripple");t.addEventListener("transitionend",function n(){t.removeEventListener("transitionend",n),Zeplin.createDialog({title:'Delete  "'+r.querySelector(".screenName").value+'"?',message:"Deleted screens cannot be restored.",done:{name:"DELETE",cb:function(){sn(o.dataset.id)}},cancel:{name:"CANCEL"}}),an()})}}),r.appendChild(n)}});var La=document.getElementById("slackSettings");La.addEventListener("click",function(e){e.stopPropagation(),Ei.classList.toggle("hidden")});var xa=document.getElementById("prevSlackIntegration"),ba=document.getElementById("integrations")}}();